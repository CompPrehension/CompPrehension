(()=>{"use strict";var e,t={3890:(e,t,n)=>{var s=n(3935),r=n(7294),o=(n(8660),n(3195)),i=n(935);function a(e,t){return i.G0([e,i.lB,i.S1,i.i0("")],null!=t?t:e.name)}function l(e){return null!=e}const d=i.dt({attemptId:i.pk,exerciseId:i.pk,questionIds:i.IX(i.pk)},"ExerciseAttempt"),c=a(d),u=i.dt({attemptId:i.pk,questionsCount:i.pk,totalInteractionsCount:i.pk,totalInteractionsWithErrorsCount:i.pk,averageGrade:i.pk},"ExerciseStatisticsItem"),p=i.IX(u),m=i.dt({type:i.mM({SUCCESS:null,ERROR:null}),message:i.Z_,violationLaws:i.IX(i.Z_)}),w=i.r$({grade:i.G0([i.pk,i.lB]),violations:i.G0([i.IX(i.pk),i.lB]),correctAnswers:i.G0([i.IX(i.bc([i.pk,i.pk])),i.lB]),correctSteps:i.G0([i.pk,i.lB]),stepsLeft:i.G0([i.pk,i.lB]),stepsWithErrors:i.G0([i.pk,i.lB]),message:i.G0([i.IX(m),i.lB])},"Feedback"),h=i.jV([w,i.r$({trace:i.G0([i.IX(i.Z_),i.lB])})]),g=i.dt({requireContext:i.O7,showSupplementaryQuestions:i.O7},"QuestionOptions"),v=i.jV([g,i.dt({showTrace:i.O7,multipleSelectionEnabled:i.O7,requireAllAnswers:i.O7}),i.r$({orderNumberOptions:i.jV([i.dt({delimiter:i.Z_,position:i.mM({PREFIX:null,SUFFIX:null,NONE:null})}),i.r$({replacers:i.G0([i.IX(i.Z_),i.lB])})])})],"OrderQuestionOptions"),f=i.jV([g,i.dt({multipleSelectionEnabled:i.O7}),i.G0([i.dt({displayMode:i.i0("combobox")}),i.dt({displayMode:i.i0("dragNdrop"),draggableStyle:i.Z_,dropzoneStyle:i.Z_,dropzoneHtml:i.Z_})])],"MatchingQuestionOptions"),E=i.jV([g,i.dt({displayMode:i.mM({radio:null,dragNdrop:null})})],"SingleChoiceQuestionOptions"),y=i.jV([g,i.G0([i.jV([i.dt({displayMode:i.i0("switch")}),i.r$({selectorReplacers:i.G0([i.bc([i.Z_,i.Z_]),i.lB])})]),i.dt({displayMode:i.i0("dragNdrop"),dropzoneHtml:i.Z_,dropzoneStyle:i.Z_,draggableStyle:i.Z_})])],"MultiChoiceQuestionOptions"),x=i.mM({SINGLE_CHOICE:null,MULTI_CHOICE:null,MATCHING:null,ORDER:null},"QuestionType"),b=i.Z_,I=i.dt({id:i.pk,text:b},"QuestionAnswer"),q=i.dt({attemptId:i.pk,questionId:i.pk,type:x,options:g,text:b,answers:i.IX(I),responses:i.G0([i.IX(i.bc([i.pk,i.pk])),i.lB]),feedback:i.G0([w,i.lB])},"QuestionBase"),_=i.jV([q,i.dt({type:i.i0("ORDER"),options:v,feedback:i.G0([h,i.lB])}),i.r$({initialTrace:i.G0([i.IX(i.Z_),i.lB])})],"OrderQuestion"),C=i.jV([q,i.dt({type:i.i0("SINGLE_CHOICE"),options:E})],"SingleChoiceQuestion"),S=i.jV([q,i.dt({type:i.i0("MULTI_CHOICE"),options:y})],"MultiChoiceQuestion"),O=i.jV([q,i.dt({type:i.i0("MATCHING"),answers:i.IX(I),groups:i.IX(I),options:f})],"MatchingQuestion"),A=i.G0([_,C,S,O],"Question"),k=a(A),Q=i.mM({STUDENT:null,TEACHER:null,ADMIN:null},"Role"),L=i.dt({id:i.pk,displayName:i.Z_,email:i.G0([i.Z_,i.lB]),roles:i.IX(Q)},"UserInfo"),N=i.dt({newQuestionGenerationEnabled:i.O7,supplementaryQuestionsEnabled:i.O7,correctAnswerGenerationEnabled:i.O7},"ExerciseOptions"),M=i.dt({id:i.pk,options:N},"Exercise"),$=i.dt({sessionId:i.Z_,exercise:M,user:L,language:i.Z_},"SessionInfo");var j=n(7997),H=n(5974),P=n(7967),T=n(902),R=function(e,t,n,s){return new(n||(n=Promise))((function(r,o){function i(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};function Z(e,t){return R(this,void 0,void 0,(function*(){return console.log(`ajax get: ${e}`),yield V(e,void 0,t)}))}function G(e,t,n){return R(this,void 0,void 0,(function*(){const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};return console.log(`ajax post: ${e}`,t),yield V(e,s,n)}))}function V(e,t,n){return R(this,void 0,void 0,(function*(){const s=new j.Fetcher(e,t).handle(200,(e=>(0,H.right)(e)),n).handle(500,(e=>(0,H.left)(e))).discardRest((()=>(0,H.left)({message:"Unexpected server error"}))),[r,o]=yield s.run().catch((()=>R(this,void 0,void 0,(function*(){return[(0,H.left)({message:"Connection error"}),P.none]}))));if(P.isSome(o)){const e={message:`Type inconsistency for properties of ${null==n?void 0:n.name} type: ${B((0,H.left)(o.value)).join(", ")}`};return console.error(e),(0,H.left)(e)}return H.fold((e=>console.error(e)),(e=>console.log(e)))(r),r}))}const B=e=>(0,T.pipe)(e,H.fold((e=>e.map((e=>e.context.map((({key:e})=>e)).join(".")))),(()=>["no errors"])));var F;let z=F=class{static initEndpointPath(){const e=/^\/(?:.+\/(?<!\/pages\/))?/.exec(window.location.pathname);return e?e[0]:"/"}loadSessionInfo(){return Z(`${F.endpointPath}loadSessionInfo`,$)}getQuestion(e){return Z(`${F.endpointPath}getQuestion?questionId=${e}`,A)}generateQuestion(e){return Z(`${F.endpointPath}generateQuestion?attemptId=${e}`,A)}generateSupplementaryQuestion(e){return G(`${F.endpointPath}generateSupplementaryQuestion`,e,k)}generateNextCorrectAnswer(e){return Z(`${F.endpointPath}generateNextCorrectAnswer?questionId=${e}`,w)}addQuestionAnswer(e){return G(`${F.endpointPath}addQuestionAnswer`,e,w)}getExistingExerciseAttempt(e){return Z(`${F.endpointPath}getExistingExerciseAttempt?exerciseId=${e}`,c)}createExerciseAttempt(e){return Z(`${F.endpointPath}createExerciseAttempt?exerciseId=${e}`,d)}getExerciseStatistics(e){return Z(`${F.endpointPath}getExerciseStatistics?exerciseId=${e}`,p)}getExercises(){return Z(`${F.endpointPath}getExercises`,i.IX(i.pk))}};z.endpointPath=F.initEndpointPath(),z=F=function(e,t,n,s){var r,o=arguments.length,i=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(o<3?r(i):o>3?r(t,n,i):r(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i}([(0,o.b2)()],z);var D=function(e,t,n,s){return new(n||(n=Promise))((function(r,o){function i(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};let X=class{loadSessionInfo(){return D(this,void 0,void 0,(function*(){return console.log("loadSessionInfo"),H.right({sessionId:"test_session",exercise:{id:-1,options:{correctAnswerGenerationEnabled:!0,newQuestionGenerationEnabled:!0,supplementaryQuestionsEnabled:!0}},language:"EN",user:{id:999999,displayName:"front user",email:"test@mail.ru",roles:["ADMIN"]}})}))}getExistingExerciseAttempt(e){return D(this,void 0,void 0,(function*(){return console.log(`getExistingExerciseAttempt?exerciseId=${e}`),H.right("")}))}createExerciseAttempt(e){return D(this,void 0,void 0,(function*(){return console.log(`createExerciseAttempt?exerciseId=${e}`),H.right({attemptId:-1,exerciseId:-1,questionIds:[1,2,3,4,5,6,7]})}))}getQuestion(e){return D(this,void 0,void 0,(function*(){let t;return console.log(`getQuestion?questionId=${e}`),1===e&&(t={type:"SINGLE_CHOICE",attemptId:-1,questionId:1,text:"question text",answers:[{id:0,text:"answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 "},{id:1,text:"answer2answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 "},{id:2,text:"answer2answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 "}],responses:[],feedback:null,options:{requireContext:!1,showSupplementaryQuestions:!0,displayMode:"radio"}}),2===e&&(t={type:"MULTI_CHOICE",attemptId:-1,questionId:2,text:"question text",answers:[{id:0,text:"answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 "},{id:1,text:"answer2answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 "},{id:2,text:"answer2answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 "}],responses:[],feedback:null,options:{requireContext:!1,showSupplementaryQuestions:!0,displayMode:"switch"}}),3===e&&(t={type:"SINGLE_CHOICE",attemptId:-1,questionId:3,text:'question text with <span id="answer_0">select1</span> and <span id="answer_1">select2</span>',answers:[],responses:[],feedback:null,options:{requireContext:!0,showSupplementaryQuestions:!0,displayMode:"radio"}}),4===e&&(t={type:"MULTI_CHOICE",attemptId:-1,questionId:4,text:'question text with <span id="answer_0"></span> and <span id="answer_1"></span>',answers:[],responses:[],feedback:null,options:{requireContext:!0,showSupplementaryQuestions:!0,displayMode:"switch"}}),5===e&&(t={type:"MATCHING",attemptId:-1,questionId:5,text:"question text ",answers:[{id:0,text:"test1"},{id:1,text:"test2"},{id:3,text:"test3"}],groups:[{id:0,text:'<div style="width:70px; height: 40px;">group1<div/>'},{id:1,text:'<div style="width:50px;height: 100px;">group2 group2 group2 group2<div/>'}],responses:[],feedback:null,options:{requireContext:!1,showSupplementaryQuestions:!0,displayMode:"dragNdrop",multipleSelectionEnabled:!0,dropzoneStyle:'{ "display": "inline-block", "minHeight": "40px", "minWidth": "80px" }',dropzoneHtml:"drop",draggableStyle:'{ "padding": "10px", "border": "5px solid", "borderRadius": "5px", "borderColor": "black", "backgroundColor": "white" }'}}),6===e&&(t={type:"MATCHING",attemptId:-1,questionId:6,text:'question text with <span id="answer_0">drop</span> and <span id="answer_1">drop</span>',answers:[],groups:[{id:0,text:'<div style="width:70px; height: 40px;">group1<div/>'},{id:1,text:'<div style="width:50px;height: 100px;">group2 group2 group2 group2<div/>'}],responses:[],feedback:null,options:{requireContext:!0,showSupplementaryQuestions:!0,displayMode:"dragNdrop",multipleSelectionEnabled:!1,dropzoneStyle:'{ "display": "inline-block", "minHeight": "40px", "minWidth": "80px" }',dropzoneHtml:"drop",draggableStyle:'{ "padding": "10px", "border": "5px solid", "borderRadius": "5px", "borderColor": "black", "backgroundColor": "white" }'}}),7===e&&(t={type:"MULTI_CHOICE",attemptId:-1,questionId:7,text:'question text with <span id="answer_0"></span> and <span id="answer_1"></span>',answers:[],responses:[],feedback:null,options:{requireContext:!0,showSupplementaryQuestions:!0,displayMode:"dragNdrop",dropzoneStyle:'{ "display": "inline-block", "height": "20px", "width": "20px" }',dropzoneHtml:"",draggableStyle:'{ "height": "20px", "width": "20px" }'}}),t?H.right(t):H.left({message:"No such question"})}))}generateQuestion(e){return D(this,void 0,void 0,(function*(){return console.log(`generateQuestion?attemptId=${e}`),H.left({message:"Method not implemented."})}))}generateSupplementaryQuestion(e){return D(this,void 0,void 0,(function*(){return console.log("generateSupplementaryQuestion",e),H.left({message:"Method not implemented."})}))}generateNextCorrectAnswer(e){return D(this,void 0,void 0,(function*(){return console.log(`generateNextCorrectAnswer?questionId=${e}`),H.left({message:"Method not implemented."})}))}addQuestionAnswer(e){return D(this,void 0,void 0,(function*(){return console.log("addQuestionAnswer",e),H.left({message:"Method not implemented."})}))}getExerciseStatistics(e){return D(this,void 0,void 0,(function*(){return console.log(`getExerciseStatistics?exerciseId=${e}`),H.left({message:"Method not implemented."})}))}getExercises(){return D(this,void 0,void 0,(function*(){return console.log("getExercises"),H.left({message:"Method not implemented."})}))}};X=function(e,t,n,s){var r,o=arguments.length,i=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(o<3?r(i):o>3?r(t,n,i):r(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i}([(0,o.b2)()],X);var W=n(8949),U=n(427),J=function(e,t,n,s){var r,o=arguments.length,i=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(o<3?r(i):o>3?r(t,n,i):r(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i},K=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Y=function(e,t,n,s){return new(n||(n=Promise))((function(r,o){function i(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};let ee=class{constructor(e){this.exerciseController=e,this.isQuestionLoading=!1,this.answersHistory=[],this.isFeedbackLoading=!1,this.isFeedbackVisible=!0,this.feedback=void 0,this.question=void 0,this.onQuestionLoaded=e=>{(0,W.z)((()=>{var t,n;e=this.processLoadedQuestion(e),this.isQuestionLoading=!1,this.question=e,this.feedback=null!==(t=null==e?void 0:e.feedback)&&void 0!==t?t:void 0,this.isFeedbackVisible=!0,this.answersHistory=null!==(n=null==e?void 0:e.responses)&&void 0!==n?n:[]}))},this.processLoadedQuestion=e=>((null==e?void 0:e.options.requireContext)&&(e.text=e.text.replaceAll(/(\<.*?\sid\s*?\=([\'\"]))\s*(answer_.+?\2)(.*?\>)/gim,`$1question_${e.questionId}_$3$4`)),e),this.loadQuestion=e=>Y(this,void 0,void 0,(function*(){this.isQuestionLoading=!0;const t=yield this.exerciseController.getQuestion(e),n=H.getOrElseW((e=>{}))(t);this.onQuestionLoaded(n)})),this.generateQuestion=e=>Y(this,void 0,void 0,(function*(){this.isQuestionLoading=!0;const t=yield this.exerciseController.generateQuestion(e),n=H.getOrElseW((e=>{}))(t);this.onQuestionLoaded(n)})),this.generateSupplementaryQuestion=(e,t,n)=>Y(this,void 0,void 0,(function*(){const s={exerciseAttemptId:e,questionId:t,violationLaws:(0,T.pipe)(U.fromArray(n),P.getOrElse((()=>["invalid_law"])))};this.isQuestionLoading=!0;const r=yield this.exerciseController.generateSupplementaryQuestion(s),o=H.getOrElseW((e=>{}))(r);this.onQuestionLoaded(o||void 0)})),this.generateNextCorrectAnswer=()=>Y(this,void 0,void 0,(function*(){const{question:e}=this;if(!e)throw new Error("Current question not found");this.isFeedbackLoading=!0;const t=yield this.exerciseController.generateNextCorrectAnswer(e.questionId),n=H.getOrElseW((e=>{}))(t);(0,W.z)((()=>{this.isFeedbackLoading=!1,this.feedback=n,this.isFeedbackVisible=!0,n&&n.correctAnswers&&this.isHistoryChanged(n.correctAnswers)&&(this.answersHistory=n.correctAnswers)}))})),this.sendAnswersImpl=(e,t,n)=>Y(this,void 0,void 0,(function*(){const s=(0,W.ZN)({attemptId:e,questionId:t,answers:(0,W.ZN)(n)});this.isFeedbackLoading=!0;const r=yield this.exerciseController.addQuestionAnswer(s),o=H.getOrElseW((e=>{}))(r);(0,W.z)((()=>{this.isFeedbackLoading=!1,this.feedback=o,this.isFeedbackVisible=!0,o&&o.correctAnswers&&this.isHistoryChanged(o.correctAnswers)&&(this.answersHistory=o.correctAnswers)}))})),this.sendAnswers=()=>Y(this,void 0,void 0,(function*(){const{question:e,answersHistory:t}=this;e&&(yield this.sendAnswersImpl(e.attemptId,e.questionId,(0,W.ZN)(t)))})),this.onAnswersChanged=(e,t=!0)=>Y(this,void 0,void 0,(function*(){this.answersHistory.push(e),t&&(yield this.sendAnswers())})),this.updateAnswersHistory=(e,t=!0)=>Y(this,void 0,void 0,(function*(){this.answersHistory=[...e],t&&(yield this.sendAnswers())})),this.isHistoryChanged=e=>{const{answersHistory:t}=this;return e.length!==t.length||JSON.stringify(e.sort())!==JSON.stringify(t.sort())},(0,W.rC)(this)}};var te,ne;J([W.LO,K("design:type",Boolean)],ee.prototype,"isQuestionLoading",void 0),J([W.LO,K("design:type",Array)],ee.prototype,"answersHistory",void 0),J([W.LO,K("design:type",Boolean)],ee.prototype,"isFeedbackLoading",void 0),J([W.LO,K("design:type",Boolean)],ee.prototype,"isFeedbackVisible",void 0),J([W.LO,K("design:type",Object)],ee.prototype,"feedback",void 0),J([W.LO,K("design:type",Object)],ee.prototype,"question",void 0),J([W.aD,K("design:type",Object)],ee.prototype,"loadQuestion",void 0),J([W.aD,K("design:type",Object)],ee.prototype,"generateQuestion",void 0),J([W.aD,K("design:type",Object)],ee.prototype,"generateSupplementaryQuestion",void 0),J([W.aD,K("design:type",Object)],ee.prototype,"generateNextCorrectAnswer",void 0),J([W.aD,K("design:type",Object)],ee.prototype,"sendAnswersImpl",void 0),J([W.aD,K("design:type",Object)],ee.prototype,"sendAnswers",void 0),J([W.aD,K("design:type",Object)],ee.prototype,"onAnswersChanged",void 0),J([W.aD,K("design:type",Object)],ee.prototype,"updateAnswersHistory",void 0),ee=J([(0,o.b2)(),(te=0,ne=(0,o.f3)(z),function(e,t){ne(e,t,te)}),K("design:paramtypes",[Object])],ee);var se=function(e,t,n,s){var r,o=arguments.length,i=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(o<3?r(i):o>3?r(t,n,i):r(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i},re=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},oe=function(e,t){return function(n,s){t(n,s,e)}},ie=function(e,t,n,s){return new(n||(n=Promise))((function(r,o){function i(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};let ae=class{constructor(e,t){this.exerciseController=e,this.isSessionLoading=!1,this.sessionInfo=void 0,this.currentAttempt=void 0,this.loadSessionInfo=()=>ie(this,void 0,void 0,(function*(){if(this.sessionInfo)throw new Error("Session exists");if(this.isSessionLoading)return;this.isSessionLoading=!0;const e=yield this.exerciseController.loadSessionInfo(),t=H.getOrElseW((e=>{}))(e);(0,W.z)((()=>{this.isSessionLoading=!1,this.sessionInfo=t}))})),this.loadExistingExerciseAttempt=()=>ie(this,void 0,void 0,(function*(){const{sessionInfo:e}=this;if(!e)throw new Error("Session is not defined");const t=e.exercise.id,n=yield this.exerciseController.getExistingExerciseAttempt(t),s=H.getOrElseW((()=>{}))(n);return!!s&&((0,W.z)((()=>{this.currentAttempt=s})),!0)})),this.createExerciseAttempt=()=>ie(this,void 0,void 0,(function*(){const{sessionInfo:e}=this;if(!e)throw new Error("Session is not defined");const t=e.exercise.id,n=yield this.exerciseController.createExerciseAttempt(+t),s=H.getOrElseW((()=>{}))(n);(0,W.z)((()=>{this.currentAttempt=s}))})),this.generateQuestion=()=>ie(this,void 0,void 0,(function*(){var e,t;const{sessionInfo:n,currentAttempt:s}=this;if(!n||!s)throw new Error("Session is not defined");yield this.currentQuestion.generateQuestion(s.attemptId),s.questionIds.push(null!==(t=null===(e=this.currentQuestion.question)||void 0===e?void 0:e.questionId)&&void 0!==t?t:-1)})),this.currentQuestion=t,(0,W.rC)(this)}};se([W.LO,re("design:type",Boolean)],ae.prototype,"isSessionLoading",void 0),se([W.LO,re("design:type",Object)],ae.prototype,"sessionInfo",void 0),se([W.LO,re("design:type",Object)],ae.prototype,"currentAttempt",void 0),se([W.LO,re("design:type",ee)],ae.prototype,"currentQuestion",void 0),se([W.aD,re("design:type",Object)],ae.prototype,"loadSessionInfo",void 0),se([W.aD,re("design:type",Object)],ae.prototype,"loadExistingExerciseAttempt",void 0),se([W.aD,re("design:type",Object)],ae.prototype,"createExerciseAttempt",void 0),se([W.aD,re("design:type",Object)],ae.prototype,"generateQuestion",void 0),ae=se([(0,o.b2)(),oe(0,(0,o.f3)(z)),oe(1,(0,o.f3)(ee)),re("design:paramtypes",[Object,ee])],ae);const le=new URLSearchParams(window.location.search),de=null!==le.get("sandbox")&&void 0!==le.get("sandbox");o.nC.register(z,de?X:z),o.nC.register(ee,ee),o.nC.registerSingleton(ae);var ce=n(3727),ue=n(5977),pe=n(150),me=n(5005);const we=(0,pe.Pi)((()=>{var e,t;const[n]=(0,r.useState)((()=>o.nC.resolve(ae)));if(!(null===(e=n.sessionInfo)||void 0===e?void 0:e.exercise.options.newQuestionGenerationEnabled))return null;const{sessionInfo:s,currentAttempt:i}=n,{question:a}=n.currentQuestion;if(!a||!s||!i)return null;const{user:l}=s,{questionIds:d}=i;return l.roles.includes("ADMIN")||l.roles.includes("TEACHER")||d[d.length-1]===a.questionId&&0===(null===(t=n.currentQuestion.feedback)||void 0===t?void 0:t.stepsLeft)?r.createElement("div",{style:{marginTop:"20px"}},r.createElement(me.Z,{onClick:()=>{n.generateQuestion()},variant:"primary"},"Next question")):null}));var he=n(8889);const ge=e=>{const{isVisible:t,children:n}=e;return t?r.createElement(r.Fragment,null,n):null};var ve=n(8966);const fe=(0,pe.Pi)((()=>{const[e]=(0,r.useState)((()=>o.nC.resolve(ae)));if(!e.currentQuestion.question||!e.currentAttempt)return null;const{questionId:t}=e.currentQuestion.question,{questionIds:n}=e.currentAttempt;return r.createElement("div",{className:"d-flex justify-content-center"},r.createElement(ve.Z,{className:"p-3",style:{marginBottom:"0 !important"}},r.createElement(ge,{isVisible:n.length>=5},r.createElement(ve.Z.First,{disabled:t===n[0],onClick:()=>e.currentQuestion.loadQuestion(n[0])}),r.createElement(ve.Z.Prev,{disabled:t===n[0],onClick:()=>e.currentQuestion.loadQuestion(n[n.indexOf(t)-1])})),n.map(((n,s)=>r.createElement(ve.Z.Item,{key:s+1,active:t===n,onClick:()=>e.currentQuestion.loadQuestion(n)},s+1))),r.createElement(ge,{isVisible:n.length>=5},r.createElement(ve.Z.Next,{disabled:t===n[n.length-1],onClick:()=>e.currentQuestion.loadQuestion(n[n.indexOf(t)+1])}),r.createElement(ve.Z.Last,{disabled:t===n[n.length-1],onClick:()=>e.currentQuestion.loadQuestion(n[n.length-1])}))))})),Ee=(0,pe.Pi)((()=>{var e;const[t]=(0,r.useState)((()=>o.nC.resolve(ae))),{currentAttempt:n,sessionInfo:s,currentQuestion:i}=t;if(!n||!s)return null;const{user:a}=s,l=n.questionIds.findIndex((e=>{var t;return(null===(t=i.question)||void 0===t?void 0:t.questionId)===e}));return r.createElement(he.Z,{className:"px-0"},r.createElement(ge,{isVisible:-1!==l},r.createElement("h5",null,"Question #",l+1)),r.createElement(he.Z.Collapse,{className:"justify-content-end"},r.createElement(fe,null),r.createElement(he.Z.Text,{className:"px-2"},"Language: ",r.createElement("a",{href:"#language"},s.language)),r.createElement(he.Z.Toggle,null),r.createElement(he.Z.Text,{className:"px-2"},"Signed in as: ",r.createElement(ce.rU,{to:`statistics?exerciseId=${null===(e=t.currentAttempt)||void 0===e?void 0:e.exerciseId}`},a.displayName))))}));var ye=n(6968);const xe=e=>{var t;const n=null!==(t=e.delay)&&void 0!==t?t:0,[s,o]=(0,r.useState)(0===n);return(0,r.useEffect)((()=>{n>0&&setTimeout((()=>!s&&o(!0)),n)})),s?r.createElement(ye.Z,{animation:"border",variant:"primary"}):null},be=e=>{const{children:t,isLoading:n}=e;return n?r.createElement(xe,Object.assign({},e)):r.createElement(r.Fragment,null,t)};var Ie=n(4202);const qe=e=>{const{title:t,primaryBtnTitle:n,handlePrimaryBtnClicked:s,secondaryBtnTitle:o,handleSecondaryBtnClicked:i,children:a,closeButton:d,show:c,handleClose:u,type:p,size:m}=e;return r.createElement(ge,{isVisible:null==c||c},r.createElement(_e,{type:null!=p?p:"MODAL",show:null==c||c,onHide:u,size:m},r.createElement(ge,{isVisible:l(t)&&t.length>0},r.createElement(Ie.Z.Header,{closeButton:d},r.createElement(Ie.Z.Title,null,t))),r.createElement(Ie.Z.Body,null,a),o||n?r.createElement(Ie.Z.Footer,null,o?r.createElement(me.Z,{variant:"secondary",onClick:i},o):null,n?r.createElement(me.Z,{variant:"primary",onClick:s},n):null):null))},_e=e=>{const{type:t,show:n,onHide:s,children:o,size:i}=e;return"DIALOG"===t?r.createElement(Ie.Z.Dialog,{size:i},o):r.createElement(Ie.Z,{size:i,show:n,onHide:s},o)},Ce=(0,pe.Pi)((()=>{var e;const[t]=(0,r.useState)((()=>o.nC.resolve(ae)));if(!(null===(e=t.sessionInfo)||void 0===e?void 0:e.exercise.options.correctAnswerGenerationEnabled))return null;const{sessionInfo:n,currentAttempt:s}=t,{question:i}=t.currentQuestion;return i&&n&&s?r.createElement("div",{style:{marginTop:"20px"}},r.createElement(me.Z,{onClick:()=>{t.currentQuestion.generateNextCorrectAnswer()},variant:"primary"},"Next correct answer")):null}));var Se=n(4320),Oe=n(1694),Ae=n(554),ke=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]])}return n};const Qe=(0,pe.Pi)((e=>{const{question:t}=e,{options:n}=t;switch(!0){case"combobox"===n.displayMode&&!n.requireContext:return r.createElement(Ne,Object.assign({},e));case"combobox"===n.displayMode&&n.requireContext:return r.createElement(Me,Object.assign({},e));case"dragNdrop"===n.displayMode:return r.createElement(Le,Object.assign({},e))}return r.createElement("div",null,"Not Implemented")})),Le=(0,pe.Pi)((e=>{const{question:t,getAnswers:n,onChanged:s}=e;if("dragNdrop"!==t.options.displayMode)return null;const{groups:o=[]}=t,{options:i}=t,a=i.dropzoneStyle&&JSON.parse(i.dropzoneStyle)||{},l=i.dropzoneStyle&&JSON.parse(i.draggableStyle)||{};return(0,r.useEffect)((()=>{document.querySelectorAll(`[id^="question_${t.questionId}_answer_"]`).forEach((e=>{e.classList.add("comp-ph-dropzone"),Object.keys(a).forEach((t=>e.style[t]=a[t])),e.innerHTML=`<div class="comp-ph-dropzone-placeholder">${i.dropzoneHtml}</div>`}));const e=new Se.Droppable(document.querySelectorAll(".comp-ph-droppable-container"),{draggable:".comp-ph-draggable",dropzone:".comp-ph-dropzone",plugins:[Se.Plugins.ResizeMirror],mirror:{constrainDimensions:!0}});e.on("drag:over",(()=>console.log("is out"))),e.on("droppable:stop",(e=>{var n,r,o,a,l,d,c;const u=null===(a=null===(o=null===(r=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.dragEvent)||void 0===r?void 0:r.data)||void 0===o?void 0:o.source)||void 0===a?void 0:a.id,p=null===(d=null===(l=null==e?void 0:e.data)||void 0===l?void 0:l.dropzone)||void 0===d?void 0:d.id;if(u&&p){if(i.multipleSelectionEnabled){const e=`dragAnswerWrapper_${null!==(c=u.split("_")[1])&&void 0!==c?c:""}`,t=document.getElementById(e),n=document.getElementById(u);e!==p&&t&&n&&(t.innerHTML=n.outerHTML)}setTimeout((()=>{const e=[...document.querySelectorAll(`[id^="question_${t.questionId}_answer_"] > [id^="dragAnswer_"]`)].map((e=>{var n,s,r;return[+(null!==(s=null===(n=e.parentElement)||void 0===n?void 0:n.id.split(`question_${t.questionId}_answer_`)[1])&&void 0!==s?s:""),+(null!==(r=null==e?void 0:e.id.split("dragAnswer_")[1])&&void 0!==r?r:"")]}));s(e)}),10)}}))}),[t.questionId]),r.createElement("div",null,r.createElement("div",{className:"row"},r.createElement("div",{className:"col-md"},i.requireContext?r.createElement("p",{className:"comp-ph-droppable-container comp-ph-question-text",dangerouslySetInnerHTML:{__html:t.text}}):r.createElement("p",{className:"d-flex flex-column comp-ph-droppable-container comp-ph-question-text"},t.answers.map((e=>r.createElement("div",{className:"d-flex flex-row mb-3"},r.createElement("div",{className:"mr-2 mt-1"},r.createElement("div",{id:`question_${t.questionId}_answer_${e.id}`})),r.createElement("div",{dangerouslySetInnerHTML:{__html:e.text}})))))),r.createElement("div",{className:"col-md comp-ph-droppable-container d-flex justify-content-start align-items-start flex-column"},o.map((e=>r.createElement("div",{id:`dragAnswerWrapper_${e.id}`,className:"comp-ph-dropzone mb-2",style:a},r.createElement("div",{className:"comp-ph-dropzone-placeholder",dangerouslySetInnerHTML:{__html:i.dropzoneHtml}}),r.createElement("div",{id:`dragAnswer_${e.id}`,className:"comp-ph-draggable",style:l,dangerouslySetInnerHTML:{__html:e.text}})))))))})),Ne=(0,pe.Pi)((e=>{const{question:t,getAnswers:n,onChanged:s}=e;if("combobox"!==t.options.displayMode)return null;const{groups:o=[]}=t,i=o.reduce(((e,t)=>t.text.length>e?t.text.length:e),0);return r.createElement("div",null,r.createElement("p",{className:"mb-5 comp-ph-question-text",dangerouslySetInnerHTML:{__html:t.text}}),r.createElement("div",null,t.answers.map((e=>{var a,l;return r.createElement("div",{className:"row mb-3"},r.createElement("div",{className:"col-md-6",dangerouslySetInnerHTML:{__html:t.text}}),r.createElement("div",{className:"col-md-auto"},r.createElement("div",{style:{width:8*i+100+"px"}},r.createElement(Oe.ZP,{defaultValue:null!==(l=null===(a=n().find((t=>t[0]===e.id)))||void 0===a?void 0:a[1])&&void 0!==l?l:null,options:o.map((e=>({value:e.id,label:e.text}))),components:{Option:$e,SingleValue:je},onChange:t=>{if(!t)return;const r=[...n().filter((t=>t[0]!==e.id)),[e.id,+t.value]];s(r)}}))))}))))})),Me=(0,pe.Pi)((e=>{const{question:t,getAnswers:n,onChanged:o}=e;if("combobox"!==t.options.displayMode)return null;const{groups:i=[],options:a}=t;return(0,r.useEffect)((()=>{document.querySelectorAll(`[id^="question_${t.questionId}_answer_"]`).forEach((e=>{var a;const l=+(null===(a=e.id)||void 0===a?void 0:a.split(`question_${t.questionId}_answer_`)[1]),d=r.createElement(Oe.ZP,{options:i.map((e=>({value:e.id,label:e.text}))),components:{Option:$e,SingleValue:je},onChange:e=>{if(!e)return;const t=[...n().filter((e=>e[0]!==l)),[l,+e.value]];o(t)}});s.render(d,e)}))}),[t.questionId]),r.createElement("div",null,r.createElement("p",{className:"comp-ph-question-text",dangerouslySetInnerHTML:{__html:t.text}}))})),$e=e=>{const{innerRef:t,innerProps:n,children:s}=e,o=ke(e,["innerRef","innerProps","children"]);return r.createElement(Ae.c.Option,Object.assign({},o),r.createElement("div",Object.assign({ref:t},n,{dangerouslySetInnerHTML:{__html:e.label}})))},je=e=>{var t;const{innerRef:n,innerProps:s,children:o}=e,i=ke(e,["innerRef","innerProps","children"]);return r.createElement(Ae.c.SingleValue,Object.assign({},i),null===(t=e.getValue())||void 0===t?void 0:t.map((e=>r.createElement("div",Object.assign({ref:n},s,{dangerouslySetInnerHTML:{__html:e.label}})))))},He=({id:e,title:t,onChange:n})=>r.createElement("label",{htmlFor:e,onClick:()=>n(t)},t.split(/\s+/).map((e=>e[0].toUpperCase()+e.slice(1))).join(" ")),Pe=({id:e,value:t,name:n,selected:s})=>r.createElement("input",{id:e,type:"radio",name:n,checked:s===t}),Te=e=>{const[t,n]=(0,r.useState)(e.selected),s=t=>{var s;n(t),null===(s=e.onChange)||void 0===s||s.call(e,t)};return r.createElement("div",{id:e.id,className:"switch-field d-inline-flex flex-row"},e.values.map((n=>r.createElement("span",null,r.createElement(Pe,{id:`${e.id}_${n}_checkbox`,name:`${e.id}_switch`,value:n,selected:t}),r.createElement(He,{id:`${e.id}_${n}_checkbox`,title:n,onChange:s})))))},Re=(0,pe.Pi)((e=>{const{question:t}=e,{options:n}=t;switch(!0){case"switch"==n.displayMode&&!n.requireContext:return r.createElement(Ze,Object.assign({},e));case"switch"===n.displayMode&&n.requireContext:return r.createElement(Ge,Object.assign({},e));case"dragNdrop"===n.displayMode:return r.createElement(Ve,Object.assign({},e))}return r.createElement("div",null,"Not implemented")})),Ze=(0,pe.Pi)((e=>{var t;const{question:n,getAnswers:s,onChanged:o}=e;if("switch"!==n.options.displayMode)return null;const{options:i}=n,a=null!==(t=i.selectorReplacers)&&void 0!==t?t:["no","yes"];return r.createElement("div",null,r.createElement("p",null,r.createElement("div",{className:"comp-ph-question-text",dangerouslySetInnerHTML:{__html:n.text}})),r.createElement("p",{className:"d-flex flex-column"},n.answers.map((e=>{var t,i,l;return r.createElement("div",{className:"d-flex flex-row mb-3"},r.createElement("div",{className:"mr-2 mt-1"},r.createElement(Te,{id:`question_${n.questionId}_anwser_${e.id}`,selected:null!==(l=a[null===(i=null===(t=s().filter((t=>t[0]===e.id)))||void 0===t?void 0:t[0])||void 0===i?void 0:i[1]])&&void 0!==l?l:"",values:a,onChange:t=>((e,t)=>{const n=a.indexOf(t),r=[...s().filter((t=>t[0]!==e)),[e,n]];o(r)})(e.id,t)})),r.createElement("div",null,e.text))}))))})),Ge=(0,pe.Pi)((e=>{var t;const{question:n,getAnswers:o,onChanged:i}=e;if("switch"!==n.options.displayMode)return null;const{options:a}=n,l=null!==(t=a.selectorReplacers)&&void 0!==t?t:["no","yes"];return(0,r.useEffect)((()=>{document.querySelectorAll(`[id^="question_${n.questionId}_answer_"]`).forEach((e=>{var t,a,d,c,u;const p=null!==(a=null===(t=e.id)||void 0===t?void 0:t.split(`question_${n.questionId}_answer_`)[1])&&void 0!==a?a:-1,m=r.createElement(Te,{id:e.id,selected:null!==(u=l[null===(c=null===(d=o().filter((e=>e[0]===+p)))||void 0===d?void 0:d[0])||void 0===c?void 0:c[1]])&&void 0!==u?u:"",values:l,onChange:e=>((e,t)=>{const n=l.indexOf(t),s=[...o().filter((t=>t[0]!==e)),[e,n]];i(s)})(+p,e)});s.render(m,e),e.id=""}))}),[n.questionId]),(0,r.useEffect)((()=>{document.querySelectorAll(`input[id^="question_${n.questionId}_answer_"]`).forEach((e=>{var t;null===(t=e.id)||void 0===t||t.split(`question_${n.questionId}_answer_`)[1],e.checked=void 0})),o().forEach((([e,t])=>{const s=`question_${n.questionId}_answer_${e}_${l[t]}_checkbox`,r=document.getElementById(s);r&&setTimeout((()=>r.checked=!0),10)}))}),[n.questionId]),r.createElement("div",null,r.createElement("p",null,r.createElement("div",{className:"comp-ph-question-text",dangerouslySetInnerHTML:{__html:n.text}})))})),Ve=(0,pe.Pi)((e=>{const{question:t,getAnswers:n,onChanged:s,answers:o}=e;if("dragNdrop"!==t.options.displayMode)return null;const i=Object.assign(Object.assign({},t),{type:"MATCHING",options:Object.assign(Object.assign({},t.options),{multipleSelectionEnabled:!0}),groups:[{id:0,text:'<span class="badge badge-success" style="height: 100%; width: 100%;display: flex; align-items: center;justify-content: center;">âœ“</span>'},{id:1,text:'<span class="badge badge-danger" style="height: 100%; width: 100%;display: flex; align-items: center;justify-content: center;">x</span>'}]});return r.createElement(Le,{question:i,getAnswers:n,onChanged:s,answers:o})})),Be=(0,pe.Pi)((e=>{var t,n;const{question:s,getAnswers:o,onChanged:i,feedback:a}=e;if(!s.options.requireContext)return null;const{options:d}=s,c=null!==(t=d.orderNumberOptions)&&void 0!==t?t:{delimiter:"/",position:"SUFFIX"},u=document.createElement("div");u.innerHTML=s.text,(0,r.useEffect)((()=>{document.querySelectorAll(`[id^="question_${s.questionId}_answer_"]`).forEach((e=>{var t,n;const r=+(null!==(n=null===(t=e.id)||void 0===t?void 0:t.split(`question_${s.questionId}_answer_`)[1])&&void 0!==n?n:"");e.addEventListener("click",(()=>i([...o(),[r,r]])))})),document.querySelectorAll("[data-comp-ph-pos]").forEach((e=>{const t=e.getAttribute("data-comp-ph-pos");e.innerHTML+=`<span class="comp-ph-expr-top-hint">${t}</span>`}))}),[s.questionId]),(0,r.useEffect)((()=>{document.querySelectorAll(`[id^="question_${s.questionId}_answer_"]`).forEach((e=>{var t;const n=e.getAttribute("data-comp-ph-pos");e.innerHTML=(null===(t=u.querySelector(`#${e.id}`))||void 0===t?void 0:t.innerHTML)+(n?`<span class="comp-ph-expr-top-hint">${n}</span>`:""),e.classList.remove("disabled")})),o().forEach((([e],t)=>{var n,r;const o=document.querySelector(`#question_${s.questionId}_answer_${e}`);if(!o)return 0;if("NONE"!==c.position){const e=null!==(r=null===(n=c.replacers)||void 0===n?void 0:n[t])&&void 0!==r?r:t+1,s="PREFIX"===c.position?[e,o.innerHTML]:"SUFFIX"===c.position?[o.innerHTML,e]:[o.innerHTML];o.innerHTML=s.join(c.delimiter)}d.multipleSelectionEnabled&&o.classList.add("disabled")}))}),[s.questionId,o().length]);const p=null!==(n=null==a?void 0:a.trace)&&void 0!==n?n:0===o().length?s.initialTrace:null,m=d.showTrace&&l(p)&&p.length>0;return r.createElement("div",null,r.createElement("div",{className:"comp-ph-question-text",dangerouslySetInnerHTML:{__html:s.text}}),r.createElement(ge,{isVisible:m},r.createElement("p",null,r.createElement("table",{className:"comp-ph-trace"},r.createElement("tbody",null,null==p?void 0:p.map((e=>r.createElement("tr",null,r.createElement("td",{dangerouslySetInnerHTML:{__html:e}})))))))))})),Fe=(0,pe.Pi)((e=>{const{question:t}=e;switch(!0){case"radio"===t.options.displayMode&&!t.options.requireContext:return r.createElement(ze,Object.assign({},e));case"radio"===t.options.displayMode&&t.options.requireContext:return r.createElement(De,Object.assign({},e))}return r.createElement("div",null,"Not implemented")})),ze=(0,pe.Pi)((e=>{const{question:t,getAnswers:n,onChanged:s}=e;return"radio"!==t.options.displayMode?null:r.createElement("div",null,r.createElement("p",null,r.createElement("div",{className:"comp-ph-question-text",dangerouslySetInnerHTML:{__html:t.text}})),r.createElement("p",{className:"d-flex flex-column"},t.answers.map((e=>r.createElement("label",{htmlFor:`question_${t.questionId}_answer_${e.id}`,className:"d-flex flex-row mb-3"},r.createElement("div",{className:"mr-2 mt-1"},r.createElement("input",{id:`question_${t.questionId}_answer_${e.id}`,name:`switch_${t.questionId}`,type:"radio",checked:n().some((t=>t[0]===e.id)),onChange:t=>{return n=e.id,void(t.target.checked&&s([[n,n]]));var n}})),r.createElement("div",null,e.text))))))})),De=(0,pe.Pi)((e=>{const{question:t,getAnswers:n,onChanged:o}=e;if("radio"!==t.options.displayMode)return null;const{options:i}=t;return(0,r.useEffect)((()=>{document.querySelectorAll(`[id^="question_${t.questionId}_answer_"]`).forEach((e=>{var i,a;const l=null!==(a=null===(i=e.id)||void 0===i?void 0:i.split(`question_${t.questionId}_answer_`)[1])&&void 0!==a?a:-1,d=r.createElement("label",{htmlFor:`question_${t.questionId}_answer_${l}`},r.createElement("input",{id:`question_${t.questionId}_answer_${l}`,name:`switch_${t.questionId}`,type:"radio",checked:n().some((e=>e[0]===+l)),onChange:e=>{return t=+l,void(e.target.checked&&o([[t,t]]));var t}}),r.createElement("span",{dangerouslySetInnerHTML:{__html:e.innerHTML}}));s.render(d,e),e.id=""}))}),[t.questionId]),(0,r.useEffect)((()=>{document.querySelectorAll(`input[id^="question_${t.questionId}_answer_"]`).forEach((e=>{e.checked=void 0})),n().forEach((([e])=>{const n=document.getElementById(`question_${t.questionId}_answer_${e}`);n&&setTimeout((()=>n.checked=!0),10)}))}),[t.questionId,n()]),r.createElement("div",null,r.createElement("p",null,r.createElement("div",{className:"comp-ph-question-text",dangerouslySetInnerHTML:{__html:t.text}})))})),Xe=(0,pe.Pi)((e=>{const{question:t,answers:n,onChanged:s,getAnswers:o,feedback:i}=e;switch(t.type){case"MATCHING":return r.createElement(Qe,{question:t,onChanged:s,answers:n,getAnswers:o});case"MULTI_CHOICE":return r.createElement(Re,{question:t,onChanged:s,answers:n,getAnswers:o});case"SINGLE_CHOICE":return r.createElement(Fe,{question:t,onChanged:s,answers:n,getAnswers:o});case"ORDER":return r.createElement(Be,{question:t,onChanged:s,answers:n,getAnswers:o,feedback:i})}return r.createElement("div",null,"Not implemented")}));var We=n(7977),Ue=n(8375),Je=function(e,t,n,s){return new(n||(n=Promise))((function(r,o){function i(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};const Ke=(0,pe.Pi)((({violationLaws:e})=>{var t;const[n]=(0,r.useState)((()=>o.nC.resolve(ae))),[s]=(0,r.useState)((()=>o.nC.resolve(ee))),[i,a]=(0,r.useState)(!1),[l,d]=(0,r.useState)(!0);return(null===(t=n.sessionInfo)||void 0===t?void 0:t.exercise.options.supplementaryQuestionsEnabled)&&e.length?r.createElement(ge,{isVisible:l},r.createElement("div",{style:{marginTop:"20px"}},r.createElement(me.Z,{onClick:()=>Je(void 0,void 0,void 0,(function*(){var t,r;a(!0),(null===(t=n.currentAttempt)||void 0===t?void 0:t.attemptId)&&e.length&&n.currentQuestion.question&&(yield s.generateSupplementaryQuestion(n.currentAttempt.attemptId,null===(r=n.currentQuestion.question)||void 0===r?void 0:r.questionId,e),s.question||(console.log("no need to generate sup question"),d(!1)))})),variant:"primary"},"Supplementary question"),r.createElement(qe,{type:"DIALOG",size:"xl",show:i,closeButton:!1,handleClose:()=>a(!1)},r.createElement(Ye,{store:s,showExtendedFeedback:!1,onChanged:()=>Je(void 0,void 0,void 0,(function*(){var e,t,r,o;console.log("show feedback for 3 seconds"),yield(3e3,new Promise((e=>setTimeout((()=>e()),3e3))));const i=(null===(e=s.feedback)||void 0===e?void 0:e.messages)&&(null===(t=s.feedback.messages)||void 0===t?void 0:t[0].violationLaws)||[];if(!i.length)return console.log("empty violation laws"),void d(!1);(null===(r=n.currentAttempt)||void 0===r?void 0:r.attemptId)&&n.currentQuestion.question?(yield s.generateSupplementaryQuestion(n.currentAttempt.attemptId,null===(o=n.currentQuestion.question)||void 0===o?void 0:o.questionId,i),s.question||(console.log("no need to generate sup question"),d(!1))):console.log("problems with attempt")}))})))):null}));const Ye=(0,pe.Pi)((e=>{const{store:t,showExtendedFeedback:n,onChanged:s}=e,o=t.question;return t.isQuestionLoading?r.createElement(xe,null):o?r.createElement(r.Fragment,null,r.createElement(Xe,{question:o,answers:t.answersHistory,getAnswers:()=>t.answersHistory,onChanged:e=>{return n=void 0,r=void 0,i=function*(){t.isHistoryChanged(e)&&(yield t.updateAnswersHistory(e),null==s||s(e))},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{l(i.next(e))}catch(e){t(e)}}function a(e){try{l(i.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(s,a)}l((i=i.apply(n,r||[])).next())}));var n,r,o,i},feedback:t.feedback}),r.createElement(et,{store:t,showExtendedFeedback:n})):null})),et=(0,pe.Pi)((({store:e,showExtendedFeedback:t})=>{var n;const{feedback:s,isFeedbackLoading:o,isFeedbackVisible:i,isQuestionLoading:a,question:d}=e;return o?r.createElement(xe,null):s&&!a&&d?r.createElement("div",{className:"comp-ph-feedback-wrapper"},r.createElement(ge,{isVisible:i},r.createElement("p",null,null===(n=s.messages)||void 0===n?void 0:n.map((e=>r.createElement(tt,{message:e,showGenerateSupQuestion:t&&d.options.showSupplementaryQuestions})))),r.createElement(ge,{isVisible:t},r.createElement("p",null,r.createElement(ge,{isVisible:null!==s.grade},r.createElement(We.Z,{variant:"primary"},"Grade: ",s.grade)," "),r.createElement(ge,{isVisible:null!==s.correctSteps},r.createElement(We.Z,{variant:"success"},"Correct steps: ",s.correctSteps)," "),r.createElement(ge,{isVisible:l(s.stepsWithErrors)&&s.stepsWithErrors>0},r.createElement(We.Z,{variant:"danger"},"Steps with errors: ",s.stepsWithErrors)," "),r.createElement(ge,{isVisible:l(s.stepsLeft)&&s.stepsLeft>0},r.createElement(We.Z,{variant:"info"},"Steps left: ",s.stepsLeft)," "))))):null})),tt=({message:e,showGenerateSupQuestion:t})=>{const n="SUCCESS"===e.type?"success":"danger";return r.createElement(Ue.Z,{variant:n},e.message,r.createElement(ge,{isVisible:t},r.createElement(Ke,{violationLaws:"ERROR"===e.type&&e.violationLaws||[]})))},nt=(0,pe.Pi)((()=>{const[e]=(0,r.useState)((()=>o.nC.resolve(ae)));return r.createElement(Ye,{store:e.currentQuestion,showExtendedFeedback:!0})}));var st=function(e,t,n,s){return new(n||(n=Promise))((function(r,o){function i(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};const rt=(0,pe.Pi)((()=>{const[e]=(0,r.useState)((()=>o.nC.resolve(ae))),[t,n]=(0,r.useState)("INITIAL");(0,r.useEffect)((()=>{st(void 0,void 0,void 0,(function*(){e.currentQuestion.question?n("EXERCISE"):(yield e.loadSessionInfo(),(yield e.loadExistingExerciseAttempt())?n("MODAL"):(n("EXERCISE"),yield i()))}))}),[]);const s=()=>st(void 0,void 0,void 0,(function*(){var t,n,s;if(null===(t=e.currentAttempt)||void 0===t?void 0:t.questionIds.length){const t=null===(n=e.currentAttempt)||void 0===n?void 0:n.questionIds.length;yield e.currentQuestion.loadQuestion(null===(s=e.currentAttempt)||void 0===s?void 0:s.questionIds[t-1])}else yield e.generateQuestion()})),i=()=>st(void 0,void 0,void 0,(function*(){e.currentQuestion.isQuestionLoading=!0,yield e.createExerciseAttempt(),yield s()}));return r.createElement(be,{isLoading:"INITIAL"===t},r.createElement(ge,{isVisible:"EXERCISE"===t},r.createElement(Ee,null),r.createElement("div",{className:"mt-5"},r.createElement(nt,null),r.createElement(Ce,null),r.createElement(we,null))),r.createElement(ge,{isVisible:"MODAL"===t},r.createElement(qe,{type:"DIALOG",title:"Found existing attempt",primaryBtnTitle:"Continue",handlePrimaryBtnClicked:()=>{n("EXERCISE"),s()},secondaryBtnTitle:"New",handleSecondaryBtnClicked:()=>{n("EXERCISE"),i()}},r.createElement("p",null,"Would you like to continue the existing attempt or start a new one?"))))}));const ot=()=>{const[e,t]=(0,r.useState)([]),[n,s]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{var e,n,r,i;e=void 0,n=void 0,i=function*(){const e=new URLSearchParams(window.location.search).get("exerciseId");if(null===e||Number.isNaN(+e))throw new Error("Invalid exerciseId url param");const n=o.nC.resolve(z);s(!0);const r=yield n.getExerciseStatistics(+e);H.isRight(r)&&t(r.right),s(!1)},new((r=void 0)||(r=Promise))((function(t,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,a)}l((i=i.apply(e,n||[])).next())}))}),[]),r.createElement("div",null,r.createElement("table",{className:"table"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",{scope:"col"},"AttemptId"),r.createElement("th",{scope:"col"},"QuestionsCount"),r.createElement("th",{scope:"col"},"TotalInteractionsCount"),r.createElement("th",{scope:"col"},"TotalInteractionsWithErrorsCount"),r.createElement("th",{scope:"col"},"AverageGrade"))),r.createElement("tbody",null,r.createElement(be,{isLoading:n},e.map((e=>r.createElement("tr",null,r.createElement("th",{scope:"row"},e.attemptId),r.createElement("td",null,e.questionsCount),r.createElement("td",null,e.totalInteractionsCount),r.createElement("td",null,e.totalInteractionsWithErrorsCount),r.createElement("td",null,e.averageGrade))))))))};var it=n(6712);const at=(0,pe.Pi)((()=>{const[e,t]=(0,r.useState)([]),[n,s]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{var e,n,r,i;e=void 0,n=void 0,i=function*(){s(!0);const e=o.nC.resolve(z),n=yield e.getExercises();H.isRight(n)&&t(n.right),s(!1)},new((r=void 0)||(r=Promise))((function(t,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,a)}l((i=i.apply(e,n||[])).next())}))}),[]),r.createElement("div",null,r.createElement(it.Z,null,e.map((e=>r.createElement(it.Z.Item,null,r.createElement("a",{href:`exercise?exerciseId=${e}`},e))))))}));(0,s.hydrate)(r.createElement((()=>r.createElement("div",{className:"container comp-ph-container"},r.createElement(ce.VK,null,r.createElement(ue.rs,null,r.createElement(ue.AW,{path:"/**/pages/statistics"},"ExerciseList",r.createElement(ot,null)),r.createElement(ue.AW,{path:"/**/pages/exercise"},r.createElement(rt,null)),r.createElement(ue.AW,{path:"/**/pages/exercises-list"},r.createElement(at,null)))))),null),document.getElementById("root"))}},n={};function s(e){var r=n[e];if(void 0!==r)return r.exports;var o=n[e]={exports:{}};return t[e].call(o.exports,o,o.exports,s),o.exports}s.m=t,e=[],s.O=(t,n,r,o)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,r,o]=e[d],a=!0,l=0;l<n.length;l++)(!1&o||i>=o)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(a=!1,o<i&&(i=o));a&&(e.splice(d--,1),t=r())}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[n,r,o]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={47:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var r,o,[i,a,l]=n,d=0;for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(l)var c=l(s);for(t&&t(n);d<i.length;d++)o=i[d],s.o(e,o)&&e[o]&&e[o][0](),e[i[d]]=0;return s.O(c)},n=self.webpackChunkcomp_prehension=self.webpackChunkcomp_prehension||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var r=s.O(void 0,[736],(()=>s(3890)));r=s.O(r)})();