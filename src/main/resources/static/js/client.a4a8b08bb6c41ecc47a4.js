(()=>{"use strict";var e,t={1792:(e,t,n)=>{var r=n(3935),s=n(7294),o=(n(8660),n(3195)),i=n(935);function a(e,t){return i.G0([e,i.lB,i.S1,i.i0("")],null!=t?t:e.name)}function l(e){return null!=e}const d=i.dt({attemptId:i.pk,exerciseId:i.pk,questionIds:i.IX(i.pk)},"ExerciseAttempt"),c=a(d),u=i.dt({attemptId:i.pk,questionsCount:i.pk,totalInteractionsCount:i.pk,totalInteractionsWithErrorsCount:i.pk,averageGrade:i.pk},"ExerciseStatisticsItem"),p=i.IX(u),m=i.G0([i.dt({type:i.i0("SUCCESS"),message:i.Z_}),i.dt({type:i.i0("ERROR"),message:i.Z_,violationLaws:i.IX(i.Z_)})]),w=i.r$({grade:i.G0([i.pk,i.lB]),violations:i.G0([i.IX(i.pk),i.lB]),correctAnswers:i.G0([i.IX(i.bc([i.pk,i.pk])),i.lB]),correctSteps:i.G0([i.pk,i.lB]),stepsLeft:i.G0([i.pk,i.lB]),stepsWithErrors:i.G0([i.pk,i.lB]),message:i.G0([i.IX(m),i.lB])},"Feedback"),h=i.jV([w,i.r$({trace:i.G0([i.IX(i.Z_),i.lB])})]),v=i.dt({requireContext:i.O7},"QuestionOptions"),g=i.jV([v,i.dt({showTrace:i.O7,multipleSelectionEnabled:i.O7,requireAllAnswers:i.O7}),i.r$({orderNumberOptions:i.jV([i.dt({delimiter:i.Z_,position:i.mM({PREFIX:null,SUFFIX:null,NONE:null})}),i.r$({replacers:i.G0([i.IX(i.Z_),i.lB])})])})],"OrderQuestionOptions"),f=i.jV([v,i.dt({multipleSelectionEnabled:i.O7}),i.G0([i.dt({displayMode:i.i0("combobox")}),i.dt({displayMode:i.i0("dragNdrop"),draggableStyle:i.Z_,dropzoneStyle:i.Z_,dropzoneHtml:i.Z_})])],"MatchingQuestionOptions"),E=i.jV([v,i.dt({displayMode:i.mM({radio:null,dragNdrop:null})})],"SingleChoiceQuestionOptions"),y=i.jV([v,i.G0([i.jV([i.dt({displayMode:i.i0("switch")}),i.r$({selectorReplacers:i.G0([i.bc([i.Z_,i.Z_]),i.lB])})]),i.dt({displayMode:i.i0("dragNdrop"),dropzoneHtml:i.Z_,dropzoneStyle:i.Z_,draggableStyle:i.Z_})])],"MultiChoiceQuestionOptions"),x=i.mM({SINGLE_CHOICE:null,MULTI_CHOICE:null,MATCHING:null,ORDER:null},"QuestionType"),b=i.Z_,I=i.dt({id:i.pk,text:b},"QuestionAnswer"),C=i.dt({attemptId:i.pk,questionId:i.pk,type:x,options:v,text:b,answers:i.IX(I),responses:i.G0([i.IX(i.bc([i.pk,i.pk])),i.lB]),feedback:i.G0([w,i.lB])},"QuestionBase"),S=i.jV([C,i.dt({type:i.i0("ORDER"),options:g,feedback:i.G0([h,i.lB])}),i.r$({initialTrace:i.G0([i.IX(i.Z_),i.lB])})],"OrderQuestion"),O=i.jV([C,i.dt({type:i.i0("SINGLE_CHOICE"),options:E})],"SingleChoiceQuestion"),A=i.jV([C,i.dt({type:i.i0("MULTI_CHOICE"),options:y})],"MultiChoiceQuestion"),q=i.jV([C,i.dt({type:i.i0("MATCHING"),answers:i.IX(I),groups:i.IX(I),options:f})],"MatchingQuestion"),_=i.G0([S,O,A,q],"Question"),L=a(_),k=i.mM({STUDENT:null,TEACHER:null,ADMIN:null},"Role"),N=i.dt({id:i.pk,displayName:i.Z_,email:i.G0([i.Z_,i.lB]),roles:i.IX(k)},"UserInfo"),M=i.dt({sessionId:i.Z_,exerciseId:i.pk,user:N,language:i.Z_},"SessionInfo");var Q=n(7997),j=n(5974),H=n(7967),T=n(902),$=function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};function P(e,t){return $(this,void 0,void 0,(function*(){return console.log(`ajax get: ${e}`),yield Z(e,void 0,t)}))}function R(e,t,n){return $(this,void 0,void 0,(function*(){const r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};return console.log(`ajax post: ${e}`,t),yield Z(e,r,n)}))}function Z(e,t,n){return $(this,void 0,void 0,(function*(){const r=new Q.Fetcher(e,t).handle(200,(e=>(0,j.right)(e)),n).handle(500,(e=>(0,j.left)(e))).discardRest((()=>(0,j.left)({message:"Unexpected server error"}))),[s,o]=yield r.run().catch((()=>$(this,void 0,void 0,(function*(){return[(0,j.left)({message:"Connection error"}),H.none]}))));if(H.isSome(o)){const e={message:`Type inconsistency for properties of ${null==n?void 0:n.name} type: ${G((0,j.left)(o.value)).join(", ")}`};return console.error(e),(0,j.left)(e)}return j.fold((e=>console.error(e)),(e=>console.log(e)))(s),s}))}const G=e=>(0,T.pipe)(e,j.fold((e=>e.map((e=>e.context.map((({key:e})=>e)).join(".")))),(()=>["no errors"])));var B;let z=B=class{static initEndpointPath(){const e=/^\/(?:.+\/(?<!\/pages\/))?/.exec(window.location.pathname);return e?e[0]:"/"}loadSessionInfo(){return P(`${B.endpointPath}loadSessionInfo`,M)}getQuestion(e){return P(`${B.endpointPath}getQuestion?questionId=${e}`,_)}generateQuestion(e){return P(`${B.endpointPath}generateQuestion?attemptId=${e}`,_)}generateSupplementaryQuestion(e){return R(`${B.endpointPath}generateSupplementaryQuestion`,e,L)}generateNextCorrectAnswer(e){return P(`${B.endpointPath}generateNextCorrectAnswer?questionId=${e}`,w)}addQuestionAnswer(e){return R(`${B.endpointPath}addQuestionAnswer`,e,w)}getExistingExerciseAttempt(e){return P(`${B.endpointPath}getExistingExerciseAttempt?exerciseId=${e}`,c)}createExerciseAttempt(e){return P(`${B.endpointPath}createExerciseAttempt?exerciseId=${e}`,d)}getExerciseStatistics(e){return P(`${B.endpointPath}getExerciseStatistics?exerciseId=${e}`,p)}};z.endpointPath=B.initEndpointPath(),z=B=function(e,t,n,r){var s,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,n,i):s(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i}([(0,o.b2)()],z);var D=function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};let F=class{loadSessionInfo(){return D(this,void 0,void 0,(function*(){return console.log("loadSessionInfo"),j.right({sessionId:"test_session",exerciseId:-1,language:"EN",user:{id:999999,displayName:"front user",email:"test@mail.ru",roles:["ADMIN"]}})}))}getExistingExerciseAttempt(e){return D(this,void 0,void 0,(function*(){return console.log(`getExistingExerciseAttempt?exerciseId=${e}`),j.right("")}))}createExerciseAttempt(e){return D(this,void 0,void 0,(function*(){return console.log(`createExerciseAttempt?exerciseId=${e}`),j.right({attemptId:-1,exerciseId:-1,questionIds:[1,2,3,4,5,6,7]})}))}getQuestion(e){return D(this,void 0,void 0,(function*(){let t;return console.log(`getQuestion?questionId=${e}`),1===e&&(t={type:"SINGLE_CHOICE",attemptId:-1,questionId:1,text:"question text",answers:[{id:0,text:"answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 "},{id:1,text:"answer2answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 "},{id:2,text:"answer2answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 "}],responses:[],feedback:null,options:{requireContext:!1,displayMode:"radio"}}),2===e&&(t={type:"MULTI_CHOICE",attemptId:-1,questionId:2,text:"question text",answers:[{id:0,text:"answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 "},{id:1,text:"answer2answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 "},{id:2,text:"answer2answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 answer1 answer1 answer1answer1answer1answer1answer1 answer1answer1 "}],responses:[],feedback:null,options:{requireContext:!1,displayMode:"switch"}}),3===e&&(t={type:"SINGLE_CHOICE",attemptId:-1,questionId:3,text:'question text with <span id="answer_0">select1</span> and <span id="answer_1">select2</span>',answers:[],responses:[],feedback:null,options:{requireContext:!0,displayMode:"radio"}}),4===e&&(t={type:"MULTI_CHOICE",attemptId:-1,questionId:4,text:'question text with <span id="answer_0"></span> and <span id="answer_1"></span>',answers:[],responses:[],feedback:null,options:{requireContext:!0,displayMode:"switch"}}),5===e&&(t={type:"MATCHING",attemptId:-1,questionId:5,text:"question text ",answers:[{id:0,text:"test1"},{id:1,text:"test2"},{id:3,text:"test3"}],groups:[{id:0,text:'<div style="width:70px; height: 40px;">group1<div/>'},{id:1,text:'<div style="width:50px;height: 100px;">group2 group2 group2 group2<div/>'}],responses:[],feedback:null,options:{requireContext:!1,displayMode:"dragNdrop",multipleSelectionEnabled:!0,dropzoneStyle:'{ "display": "inline-block", "minHeight": "40px", "minWidth": "80px" }',dropzoneHtml:"drop",draggableStyle:'{ "padding": "10px", "border": "5px solid", "borderRadius": "5px", "borderColor": "black", "backgroundColor": "white" }'}}),6===e&&(t={type:"MATCHING",attemptId:-1,questionId:6,text:'question text with <span id="answer_0">drop</span> and <span id="answer_1">drop</span>',answers:[],groups:[{id:0,text:'<div style="width:70px; height: 40px;">group1<div/>'},{id:1,text:'<div style="width:50px;height: 100px;">group2 group2 group2 group2<div/>'}],responses:[],feedback:null,options:{requireContext:!0,displayMode:"dragNdrop",multipleSelectionEnabled:!1,dropzoneStyle:'{ "display": "inline-block", "minHeight": "40px", "minWidth": "80px" }',dropzoneHtml:"drop",draggableStyle:'{ "padding": "10px", "border": "5px solid", "borderRadius": "5px", "borderColor": "black", "backgroundColor": "white" }'}}),7===e&&(t={type:"MULTI_CHOICE",attemptId:-1,questionId:7,text:'question text with <span id="answer_0"></span> and <span id="answer_1"></span>',answers:[],responses:[],feedback:null,options:{requireContext:!0,displayMode:"dragNdrop",dropzoneStyle:'{ "display": "inline-block", "height": "20px", "width": "20px" }',dropzoneHtml:"",draggableStyle:'{ "height": "20px", "width": "20px" }'}}),t?j.right(t):j.left({message:"No such question"})}))}generateQuestion(e){return D(this,void 0,void 0,(function*(){return console.log(`generateQuestion?attemptId=${e}`),j.left({message:"Method not implemented."})}))}generateSupplementaryQuestion(e){return D(this,void 0,void 0,(function*(){return console.log("generateSupplementaryQuestion",e),j.left({message:"Method not implemented."})}))}generateNextCorrectAnswer(e){return D(this,void 0,void 0,(function*(){return console.log(`generateNextCorrectAnswer?questionId=${e}`),j.left({message:"Method not implemented."})}))}addQuestionAnswer(e){return D(this,void 0,void 0,(function*(){return console.log("addQuestionAnswer",e),j.left({message:"Method not implemented."})}))}getExerciseStatistics(e){return D(this,void 0,void 0,(function*(){return console.log(`getExerciseStatistics?exerciseId=${e}`),j.left({message:"Method not implemented."})}))}};F=function(e,t,n,r){var s,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,n,i):s(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i}([(0,o.b2)()],F);var V=n(8949),X=n(427),W=function(e,t,n,r){var s,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,n,i):s(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i},U=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},J=function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};let K=class{constructor(e){this.exerciseController=e,this.isQuestionLoading=!1,this.answersHistory=[],this.isFeedbackLoading=!1,this.feedback=void 0,this.question=void 0,this.onQuestionLoaded=e=>{(0,V.z)((()=>{var t,n;this.isQuestionLoading=!1,this.question=e,this.feedback=null!==(t=null==e?void 0:e.feedback)&&void 0!==t?t:void 0,this.answersHistory=null!==(n=null==e?void 0:e.responses)&&void 0!==n?n:[]}))},this.loadQuestion=e=>J(this,void 0,void 0,(function*(){this.isQuestionLoading=!0;const t=yield this.exerciseController.getQuestion(e),n=j.getOrElseW((e=>{}))(t);this.onQuestionLoaded(n)})),this.generateQuestion=e=>J(this,void 0,void 0,(function*(){this.isQuestionLoading=!0;const t=yield this.exerciseController.generateQuestion(e),n=j.getOrElseW((e=>{}))(t);this.onQuestionLoaded(n)})),this.generateSupplementaryQuestion=(e,t,n)=>J(this,void 0,void 0,(function*(){const r={exerciseAttemptId:e,questionId:t,violationLaws:(0,T.pipe)(X.fromArray(n),H.getOrElse((()=>["invalid_law"])))};this.isQuestionLoading=!0;const s=yield this.exerciseController.generateSupplementaryQuestion(r),o=j.getOrElseW((e=>{}))(s);this.onQuestionLoaded(o||void 0)})),this.generateNextCorrectAnswer=()=>J(this,void 0,void 0,(function*(){const{question:e}=this;if(!e)throw new Error("Current question not found");this.isFeedbackLoading=!0;const t=yield this.exerciseController.generateNextCorrectAnswer(e.questionId),n=j.getOrElseW((e=>{}))(t);(0,V.z)((()=>{this.isFeedbackLoading=!1,this.feedback=n,n&&n.correctAnswers&&this.isHistoryChanged(n.correctAnswers)&&(this.answersHistory=n.correctAnswers)}))})),this.sendAnswersImpl=(e,t,n)=>J(this,void 0,void 0,(function*(){const r=(0,V.ZN)({attemptId:e,questionId:t,answers:(0,V.ZN)(n)});this.isFeedbackLoading=!0;const s=yield this.exerciseController.addQuestionAnswer(r),o=j.getOrElseW((e=>{}))(s);(0,V.z)((()=>{this.isFeedbackLoading=!1,this.feedback=o,o&&o.correctAnswers&&this.isHistoryChanged(o.correctAnswers)&&(this.answersHistory=o.correctAnswers)}))})),this.sendAnswers=()=>J(this,void 0,void 0,(function*(){const{question:e,answersHistory:t}=this;e&&(yield this.sendAnswersImpl(e.attemptId,e.questionId,(0,V.ZN)(t)))})),this.onAnswersChanged=(e,t=!0)=>J(this,void 0,void 0,(function*(){this.answersHistory.push(e),t&&(yield this.sendAnswers())})),this.updateAnswersHistory=(e,t=!0)=>J(this,void 0,void 0,(function*(){this.answersHistory=[...e],t&&(yield this.sendAnswers())})),this.isHistoryChanged=e=>{const{answersHistory:t}=this;return e.length!==t.length||JSON.stringify(e.sort())!==JSON.stringify(t.sort())},(0,V.rC)(this)}};var Y,ee;W([V.LO,U("design:type",Boolean)],K.prototype,"isQuestionLoading",void 0),W([V.LO,U("design:type",Array)],K.prototype,"answersHistory",void 0),W([V.LO,U("design:type",Boolean)],K.prototype,"isFeedbackLoading",void 0),W([V.LO,U("design:type",Object)],K.prototype,"feedback",void 0),W([V.LO,U("design:type",Object)],K.prototype,"question",void 0),W([V.aD,U("design:type",Object)],K.prototype,"loadQuestion",void 0),W([V.aD,U("design:type",Object)],K.prototype,"generateQuestion",void 0),W([V.aD,U("design:type",Object)],K.prototype,"generateSupplementaryQuestion",void 0),W([V.aD,U("design:type",Object)],K.prototype,"generateNextCorrectAnswer",void 0),W([V.aD,U("design:type",Object)],K.prototype,"sendAnswersImpl",void 0),W([V.aD,U("design:type",Object)],K.prototype,"sendAnswers",void 0),W([V.aD,U("design:type",Object)],K.prototype,"onAnswersChanged",void 0),W([V.aD,U("design:type",Object)],K.prototype,"updateAnswersHistory",void 0),K=W([(0,o.b2)(),(Y=0,ee=(0,o.f3)("ExerciseController"),function(e,t){ee(e,t,Y)}),U("design:paramtypes",[Object])],K);var te=function(e,t,n,r){var s,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,n,i):s(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i},ne=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},re=function(e,t){return function(n,r){t(n,r,e)}},se=function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};let oe=class{constructor(e,t){this.exerciseController=e,this.isSessionLoading=!1,this.sessionInfo=void 0,this.currentAttempt=void 0,this.loadSessionInfo=()=>se(this,void 0,void 0,(function*(){if(this.sessionInfo)throw new Error("Session exists");if(this.isSessionLoading)return;this.isSessionLoading=!0;const e=yield this.exerciseController.loadSessionInfo(),t=j.getOrElseW((e=>{}))(e);(0,V.z)((()=>{this.isSessionLoading=!1,this.sessionInfo=t}))})),this.loadExistingExerciseAttempt=()=>se(this,void 0,void 0,(function*(){const{sessionInfo:e}=this;if(!e)throw new Error("Session is not defined");const t=e.exerciseId,n=yield this.exerciseController.getExistingExerciseAttempt(t),r=j.getOrElseW((()=>{}))(n);return!!r&&((0,V.z)((()=>{this.currentAttempt=r})),!0)})),this.createExerciseAttempt=()=>se(this,void 0,void 0,(function*(){const{sessionInfo:e}=this;if(!e)throw new Error("Session is not defined");const{exerciseId:t}=e,n=yield this.exerciseController.createExerciseAttempt(+t),r=j.getOrElseW((()=>{}))(n);(0,V.z)((()=>{this.currentAttempt=r}))})),this.generateQuestion=()=>se(this,void 0,void 0,(function*(){var e,t;const{sessionInfo:n,currentAttempt:r}=this;if(!n||!r)throw new Error("Session is not defined");yield this.currentQuestion.generateQuestion(r.attemptId),r.questionIds.push(null!==(t=null===(e=this.currentQuestion.question)||void 0===e?void 0:e.questionId)&&void 0!==t?t:-1)})),this.currentQuestion=t,(0,V.rC)(this)}};te([V.LO,ne("design:type",Boolean)],oe.prototype,"isSessionLoading",void 0),te([V.LO,ne("design:type",Object)],oe.prototype,"sessionInfo",void 0),te([V.LO,ne("design:type",Object)],oe.prototype,"currentAttempt",void 0),te([V.LO,ne("design:type",K)],oe.prototype,"currentQuestion",void 0),te([V.aD,ne("design:type",Object)],oe.prototype,"loadSessionInfo",void 0),te([V.aD,ne("design:type",Object)],oe.prototype,"loadExistingExerciseAttempt",void 0),te([V.aD,ne("design:type",Object)],oe.prototype,"createExerciseAttempt",void 0),te([V.aD,ne("design:type",Object)],oe.prototype,"generateQuestion",void 0),oe=te([(0,o.b2)(),re(0,(0,o.f3)("ExerciseController")),re(1,(0,o.f3)(K)),ne("design:paramtypes",[Object,K])],oe);const ie=new URLSearchParams(window.location.search),ae=null!==ie.get("istest")&&void 0!==ie.get("istest");o.nC.register("ExerciseController",ae?F:z),o.nC.register(K,K),o.nC.registerSingleton(oe);var le=n(3727),de=n(5977),ce=n(150),ue=n(5005);const pe=(0,ce.Pi)((()=>{var e;const[t]=(0,s.useState)((()=>o.nC.resolve(oe))),{sessionInfo:n,currentAttempt:r}=t,{question:i}=t.currentQuestion;if(!i||!n||!r)return null;const{user:a}=n,{questionIds:l}=r;return a.roles.includes("ADMIN")||a.roles.includes("TEACHER")||l[l.length-1]===i.questionId&&0===(null===(e=t.currentQuestion.feedback)||void 0===e?void 0:e.stepsLeft)?s.createElement("div",{style:{marginTop:"20px"}},s.createElement(ue.Z,{onClick:()=>{t.generateQuestion()},variant:"primary"},"Next question")):null}));var me=n(3333);const we=e=>{const{isVisible:t,children:n}=e;return t?s.createElement(s.Fragment,null,n):null};var he=n(8966);const ve=(0,ce.Pi)((()=>{var e,t;const[n]=(0,s.useState)((()=>o.nC.resolve(oe)));return(null===(e=n.currentAttempt)||void 0===e?void 0:e.questionIds.length)&&n.currentQuestion?s.createElement("div",{className:"d-flex justify-content-center"},s.createElement(he.Z,{className:"p-3",style:{marginBottom:"0 !important"}},null===(t=n.currentAttempt)||void 0===t?void 0:t.questionIds.map(((e,t)=>{var r;return s.createElement(he.Z.Item,{key:t+1,active:(null===(r=n.currentQuestion.question)||void 0===r?void 0:r.questionId)===e,onClick:()=>n.currentQuestion.loadQuestion(e)},t+1)})))):null})),ge=(0,ce.Pi)((()=>{var e;const[t]=(0,s.useState)((()=>o.nC.resolve(oe))),{currentAttempt:n,sessionInfo:r,currentQuestion:i}=t;if(!n||!r)return null;const{user:a}=r,l=n.questionIds.findIndex((e=>{var t;return(null===(t=i.question)||void 0===t?void 0:t.questionId)===e}));return s.createElement(me.Z,{className:"px-0"},s.createElement(we,{isVisible:-1!==l},s.createElement("h5",null,"Question #",l+1)),s.createElement(me.Z.Collapse,{className:"justify-content-end"},s.createElement(ve,null),s.createElement(me.Z.Text,{className:"px-2"},"Language: ",s.createElement("a",{href:"#language"},r.language)),s.createElement(me.Z.Toggle,null),s.createElement(me.Z.Text,{className:"px-2"},"Signed in as: ",s.createElement(le.rU,{to:`statistics?exerciseId=${null===(e=t.currentAttempt)||void 0===e?void 0:e.exerciseId}`},a.displayName))))}));var fe=n(6968);const Ee=e=>{var t;const n=null!==(t=e.delay)&&void 0!==t?t:0,[r,o]=(0,s.useState)(0===n);return(0,s.useEffect)((()=>{n>0&&setTimeout((()=>!r&&o(!0)),n)})),r?s.createElement(fe.Z,{animation:"border",variant:"primary"}):null},ye=e=>{const{children:t,isLoading:n}=e;return n?s.createElement(Ee,Object.assign({},e)):s.createElement(s.Fragment,null,t)};var xe=n(1139);const be=e=>{const{title:t,primaryBtnTitle:n,handlePrimaryBtnClicked:r,secondaryBtnTitle:o,handleSecondaryBtnClicked:i,children:a,closeButton:d,show:c,handleClose:u,type:p,size:m}=e;return s.createElement(we,{isVisible:null==c||c},s.createElement(Ie,{type:null!=p?p:"MODAL",show:null==c||c,onHide:u,size:m},s.createElement(we,{isVisible:l(t)&&t.length>0},s.createElement(xe.Z.Header,{closeButton:d},s.createElement(xe.Z.Title,null,t))),s.createElement(xe.Z.Body,null,a),o||n?s.createElement(xe.Z.Footer,null,o?s.createElement(ue.Z,{variant:"secondary",onClick:i},o):null,n?s.createElement(ue.Z,{variant:"primary",onClick:r},n):null):null))},Ie=e=>{const{type:t,show:n,onHide:r,children:o,size:i}=e;return"DIALOG"===t?s.createElement(xe.Z.Dialog,{size:i},o):s.createElement(xe.Z,{size:i,show:n,onHide:r},o)},Ce=(0,ce.Pi)((()=>{const[e]=(0,s.useState)((()=>o.nC.resolve(oe))),{sessionInfo:t,currentAttempt:n}=e,{question:r}=e.currentQuestion;return r&&t&&n?s.createElement("div",{style:{marginTop:"20px"}},s.createElement(ue.Z,{onClick:()=>{e.currentQuestion.generateNextCorrectAnswer()},variant:"primary"},"Next correct answer")):null}));var Se=n(4320),Oe=n(1694),Ae=n(554),qe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n};const _e=e=>{const{question:t}=e,{options:n}=t;switch(!0){case"combobox"===n.displayMode&&!n.requireContext:return s.createElement(ke,Object.assign({},e));case"combobox"===n.displayMode&&n.requireContext:return s.createElement(Ne,Object.assign({},e));case"dragNdrop"===n.displayMode:return s.createElement(Le,Object.assign({},e))}return s.createElement("div",null,"Not Implemented")},Le=({question:e,getAnswers:t,onChanged:n})=>{if("dragNdrop"!==e.options.displayMode)return null;const{groups:r=[]}=e,{options:o}=e,i=o.dropzoneStyle&&JSON.parse(o.dropzoneStyle)||{},a=o.dropzoneStyle&&JSON.parse(o.draggableStyle)||{};return(0,s.useEffect)((()=>{document.querySelectorAll('[id^="answer_"]').forEach((e=>{e.classList.add("comp-ph-dropzone"),Object.keys(i).forEach((t=>e.style[t]=i[t])),e.innerHTML=`<div class="comp-ph-dropzone-placeholder">${o.dropzoneHtml}</div>`}));const e=new Se.Droppable(document.querySelectorAll(".comp-ph-droppable-container"),{draggable:".comp-ph-draggable",dropzone:".comp-ph-dropzone",plugins:[Se.Plugins.ResizeMirror],mirror:{constrainDimensions:!0}});e.on("drag:over",(()=>console.log("is out"))),e.on("droppable:stop",(e=>{var t,r,s,i,a,l,d;const c=null===(i=null===(s=null===(r=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.dragEvent)||void 0===r?void 0:r.data)||void 0===s?void 0:s.source)||void 0===i?void 0:i.id,u=null===(l=null===(a=null==e?void 0:e.data)||void 0===a?void 0:a.dropzone)||void 0===l?void 0:l.id;if(c&&u){if(o.multipleSelectionEnabled){const e=`dragAnswerWrapper_${null!==(d=c.split("_")[1])&&void 0!==d?d:""}`,t=document.getElementById(e),n=document.getElementById(c);e!==u&&t&&n&&(t.innerHTML=n.outerHTML)}setTimeout((()=>{const e=[...document.querySelectorAll('[id^="answer_"] > [id^="dragAnswer_"]')].map((e=>{var t,n,r;return[+(null!==(n=null===(t=e.parentElement)||void 0===t?void 0:t.id.split("_")[1])&&void 0!==n?n:""),+(null!==(r=null==e?void 0:e.id.split("_")[1])&&void 0!==r?r:"")]}));n(e)}),10)}}))}),[e.questionId]),s.createElement("div",null,s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md"},s.createElement("p",{className:"comp-ph-droppable-container",dangerouslySetInnerHTML:{__html:e.text}}),o.requireContext?null:s.createElement("p",{className:"d-flex flex-column comp-ph-droppable-container"},e.answers.map((e=>s.createElement("div",{className:"d-flex flex-row mb-3"},s.createElement("div",{className:"mr-2 mt-1"},s.createElement("div",{id:`answer_${e.id}`})),s.createElement("div",{dangerouslySetInnerHTML:{__html:e.text}})))))),s.createElement("div",{className:"col-md comp-ph-droppable-container d-flex justify-content-start align-items-start flex-column"},r.map((e=>s.createElement("div",{id:`dragAnswerWrapper_${e.id}`,className:"comp-ph-dropzone mb-2",style:i},s.createElement("div",{className:"comp-ph-dropzone-placeholder",dangerouslySetInnerHTML:{__html:o.dropzoneHtml}}),s.createElement("div",{id:`dragAnswer_${e.id}`,className:"comp-ph-draggable",style:a,dangerouslySetInnerHTML:{__html:e.text}})))))))},ke=({question:e,getAnswers:t,onChanged:n})=>{if("combobox"!==e.options.displayMode)return null;const{groups:r=[]}=e;return s.createElement("div",null,s.createElement("p",{dangerouslySetInnerHTML:{__html:e.text}}),s.createElement("table",{style:{minWidth:"50%"}},s.createElement("tbody",null,e.answers.map((o=>{var i,a;return s.createElement("tr",null,s.createElement("td",{dangerouslySetInnerHTML:{__html:e.text}}),s.createElement("td",null,s.createElement(Oe.ZP,{defaultValue:null!==(a=null===(i=t().find((e=>e[0]===o.id)))||void 0===i?void 0:i[1])&&void 0!==a?a:null,options:r.map((e=>({value:e.id,label:e.text}))),components:{Option:Me,SingleValue:Qe},onChange:e=>{if(!e)return;const r=[...t().filter((e=>e[0]!==o.id)),[o.id,+e.value]];n(r)}})))})))))},Ne=({question:e,getAnswers:t,onChanged:n})=>{if("combobox"!==e.options.displayMode)return null;const{groups:o=[],options:i}=e;return(0,s.useEffect)((()=>{document.querySelectorAll('[id^="answer_"]').forEach((e=>{var i;const a=+(null===(i=e.id)||void 0===i?void 0:i.split("answer_")[1]),l=s.createElement(Oe.ZP,{options:o.map((e=>({value:e.id,label:e.text}))),components:{Option:Me,SingleValue:Qe},onChange:e=>{if(!e)return;const r=[...t().filter((e=>e[0]!==a)),[a,+e.value]];n(r)}});r.render(l,e)}))}),[e.questionId]),s.createElement("div",null,s.createElement("p",{dangerouslySetInnerHTML:{__html:e.text}}))},Me=e=>{const{innerRef:t,innerProps:n,children:r}=e,o=qe(e,["innerRef","innerProps","children"]);return s.createElement(Ae.c.Option,Object.assign({},o),s.createElement("div",Object.assign({ref:t},n,{dangerouslySetInnerHTML:{__html:e.label}})))},Qe=e=>{var t;const{innerRef:n,innerProps:r,children:o}=e,i=qe(e,["innerRef","innerProps","children"]);return s.createElement(Ae.c.SingleValue,Object.assign({},i),null===(t=e.getValue())||void 0===t?void 0:t.map((e=>s.createElement("div",Object.assign({ref:n},r,{dangerouslySetInnerHTML:{__html:e.label}})))))},je=({id:e,title:t,onChange:n})=>s.createElement("label",{htmlFor:e,onClick:()=>n(t)},t.split(/\s+/).map((e=>e[0].toUpperCase()+e.slice(1))).join(" ")),He=({id:e,value:t,name:n,selected:r})=>s.createElement("input",{id:e,type:"radio",name:n,checked:r===t});class Te extends s.PureComponent{constructor(){super(...arguments),this.handleChange=e=>{var t,n;null===(n=(t=this.props).onChange)||void 0===n||n.call(t,e)},this.selectionStyle=()=>({left:this.props.values.indexOf(this.props.selected)/3*100+"%"})}render(){const{selected:e}=this.props;return s.createElement("div",{id:this.props.id,className:"switch-field d-inline-flex flex-row"},this.props.values.map((t=>s.createElement("span",null,s.createElement(He,{id:`${this.props.id}_${t}_checkbox`,name:`${this.props.id}_switch`,value:t,selected:e}),s.createElement(je,{id:`${this.props.id}_${t}_checkbox`,title:t,onChange:this.handleChange})))))}}const $e=e=>{const{question:t}=e,{options:n}=t;switch(!0){case"switch"==n.displayMode&&!n.requireContext:return s.createElement(Pe,Object.assign({},e));case"switch"===n.displayMode&&n.requireContext:return s.createElement(Re,Object.assign({},e));case"dragNdrop"===n.displayMode:return s.createElement(Ze,Object.assign({},e))}return s.createElement("div",null,"Not implemented")},Pe=({question:e,getAnswers:t,onChanged:n})=>{var r;if("switch"!==e.options.displayMode)return null;const{options:o}=e,i=null!==(r=o.selectorReplacers)&&void 0!==r?r:["no","yes"];return s.createElement("div",null,s.createElement("p",null,s.createElement("div",{dangerouslySetInnerHTML:{__html:e.text}})),s.createElement("p",{className:"d-flex flex-column"},e.answers.map((e=>{var r,o,a;return s.createElement("div",{className:"d-flex flex-row mb-3"},s.createElement("div",{className:"mr-2 mt-1"},s.createElement(Te,{id:`anwser_${e.id}`,selected:null!==(a=i[null===(o=null===(r=t().filter((t=>t[0]===e.id)))||void 0===r?void 0:r[0])||void 0===o?void 0:o[1]])&&void 0!==a?a:"",values:i,onChange:r=>((e,r)=>{const s=i.indexOf(r),o=[...t().filter((t=>t[0]!==e)),[e,s]];n(o)})(e.id,r)})),s.createElement("div",null,e.text))}))))},Re=({question:e,getAnswers:t,onChanged:n})=>{var o;if("switch"!==e.options.displayMode)return null;const{options:i}=e,a=null!==(o=i.selectorReplacers)&&void 0!==o?o:["no","yes"];return(0,s.useEffect)((()=>{document.querySelectorAll('[id^="answer_"]').forEach((e=>{var o,i,l,d,c;const u=null!==(i=null===(o=e.id)||void 0===o?void 0:o.split("answer_")[1])&&void 0!==i?i:-1,p=s.createElement(Te,{id:e.id,selected:null!==(c=a[null===(d=null===(l=t().filter((e=>e[0]===+u)))||void 0===l?void 0:l[0])||void 0===d?void 0:d[1]])&&void 0!==c?c:"",values:a,onChange:e=>((e,r)=>{const s=a.indexOf(r),o=[...t().filter((t=>t[0]!==e)),[e,s]];n(o)})(+u,e)});r.render(p,e),e.id=""}))}),[e.questionId]),(0,s.useEffect)((()=>{document.querySelectorAll('input[id^="answer_"]').forEach((e=>{var t;null===(t=e.id)||void 0===t||t.split("answer_")[1],e.checked=void 0})),t().forEach((([e,t])=>{const n=`answer_${e}_${a[t]}_checkbox`,r=document.getElementById(n);r&&setTimeout((()=>r.checked=!0),10)}))}),[e.questionId,t().map((e=>`${e[0]}${e[1]}`)).join("")]),s.createElement("div",null,s.createElement("p",null,s.createElement("div",{dangerouslySetInnerHTML:{__html:e.text}})))},Ze=({question:e,getAnswers:t,onChanged:n,answers:r})=>{if("dragNdrop"!==e.options.displayMode)return null;const o=Object.assign(Object.assign({},e),{type:"MATCHING",options:Object.assign(Object.assign({},e.options),{multipleSelectionEnabled:!0}),groups:[{id:0,text:'<span class="badge badge-success" style="height: 100%; width: 100%;display: flex; align-items: center;justify-content: center;">âœ“</span>'},{id:1,text:'<span class="badge badge-danger" style="height: 100%; width: 100%;display: flex; align-items: center;justify-content: center;">x</span>'}]});return s.createElement(Le,{question:o,getAnswers:t,onChanged:n,answers:r})},Ge=({question:e,getAnswers:t,onChanged:n,feedback:r})=>{var o,i;if(!e.options.requireContext)return null;const{options:a}=e,d=null!==(o=a.orderNumberOptions)&&void 0!==o?o:{delimiter:"/",position:"SUFFIX"},c=document.createElement("div");c.innerHTML=e.text,(0,s.useEffect)((()=>{document.querySelectorAll('[id^="answer_"]').forEach((e=>{var r,s;const o=+(null!==(s=null===(r=e.id)||void 0===r?void 0:r.split("answer_")[1])&&void 0!==s?s:"");e.addEventListener("click",(()=>n([...t(),[o,o]])))})),document.querySelectorAll("[data-comp-ph-pos]").forEach((e=>{const t=e.getAttribute("data-comp-ph-pos");e.innerHTML+=`<span class="comp-ph-expr-top-hint">${t}</span>`}))}),[e.questionId]),(0,s.useEffect)((()=>{document.querySelectorAll('[id^="answer_"]').forEach((e=>{var t;const n=e.getAttribute("data-comp-ph-pos");e.innerHTML=(null===(t=c.querySelector(`#${e.id}`))||void 0===t?void 0:t.innerHTML)+(n?`<span class="comp-ph-expr-top-hint">${n}</span>`:""),e.classList.remove("disabled")})),t().forEach((([e],t)=>{var n,r;const s=document.querySelector(`#answer_${e}`);if(!s)return 0;if("NONE"!==d.position){const e=null!==(r=null===(n=d.replacers)||void 0===n?void 0:n[t])&&void 0!==r?r:t+1,o="PREFIX"===d.position?[e,s.innerHTML]:"SUFFIX"===d.position?[s.innerHTML,e]:[s.innerHTML];s.innerHTML=o.join(d.delimiter)}a.multipleSelectionEnabled&&s.classList.add("disabled")}))}),[e.questionId,t().length]);const u=null!==(i=null==r?void 0:r.trace)&&void 0!==i?i:0===t().length?e.initialTrace:null,p=a.showTrace&&l(u)&&u.length>0;return s.createElement("div",null,s.createElement("div",{dangerouslySetInnerHTML:{__html:e.text}}),s.createElement(we,{isVisible:p},s.createElement("p",null,s.createElement("table",{className:"comp-ph-trace"},s.createElement("tbody",null,null==u?void 0:u.map((e=>s.createElement("tr",null,s.createElement("td",{dangerouslySetInnerHTML:{__html:e}})))))))))},Be=e=>{const{question:t}=e;switch(!0){case"radio"===t.options.displayMode&&!t.options.requireContext:return s.createElement(ze,Object.assign({},e));case"radio"===t.options.displayMode&&t.options.requireContext:return s.createElement(De,Object.assign({},e))}return s.createElement("div",null,"Not implemented")},ze=({question:e,getAnswers:t,onChanged:n})=>"radio"!==e.options.displayMode?null:s.createElement("div",null,s.createElement("p",null,s.createElement("div",{dangerouslySetInnerHTML:{__html:e.text}})),s.createElement("p",{className:"d-flex flex-column"},e.answers.map((r=>s.createElement("label",{htmlFor:`answer_${r.id}`,className:"d-flex flex-row mb-3"},s.createElement("div",{className:"mr-2 mt-1"},s.createElement("input",{id:`answer_${r.id}`,name:`switch_${e.questionId}`,type:"radio",checked:t().some((e=>e[0]===r.id)),onChange:e=>{return t=r.id,void(e.target.checked&&n([[t,t]]));var t}})),s.createElement("div",null,r.text)))))),De=({question:e,getAnswers:t,onChanged:n})=>{if("radio"!==e.options.displayMode)return null;const{options:o}=e;return(0,s.useEffect)((()=>{document.querySelectorAll('[id^="answer_"]').forEach((o=>{var i,a;const l=null!==(a=null===(i=o.id)||void 0===i?void 0:i.split("answer_")[1])&&void 0!==a?a:-1,d=s.createElement("label",{htmlFor:`answer_${l}`},s.createElement("input",{id:`answer_${l}`,name:`switch_${e.questionId}`,type:"radio",checked:t().some((e=>e[0]===+l)),onChange:e=>{return t=+l,void(e.target.checked&&n([[t,t]]));var t}}),s.createElement("span",{dangerouslySetInnerHTML:{__html:o.innerHTML}}));r.render(d,o),o.id=""}))}),[e.questionId]),(0,s.useEffect)((()=>{document.querySelectorAll('input[id^="answer_"]').forEach((e=>{e.checked=void 0})),t().forEach((([e])=>{const t=document.getElementById(`answer_${e}`);t&&setTimeout((()=>t.checked=!0),10)}))}),[e.questionId,t()]),s.createElement("div",null,s.createElement("p",null,s.createElement("div",{dangerouslySetInnerHTML:{__html:e.text}})))},Fe=e=>{const{question:t,answers:n,onChanged:r,getAnswers:o,feedback:i}=e;switch(t.type){case"MATCHING":return s.createElement(_e,{question:t,onChanged:r,answers:n,getAnswers:o});case"MULTI_CHOICE":return s.createElement($e,{question:t,onChanged:r,answers:n,getAnswers:o});case"SINGLE_CHOICE":return s.createElement(Be,{question:t,onChanged:r,answers:n,getAnswers:o});case"ORDER":return s.createElement(Ge,{question:t,onChanged:r,answers:n,getAnswers:o,feedback:i})}return s.createElement("div",null,"Not implemented")};var Ve=n(7977),Xe=n(8375),We=function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};const Ue=(0,ce.Pi)((({violationLaws:e})=>{const[t]=(0,s.useState)((()=>o.nC.resolve(oe))),[n]=(0,s.useState)((()=>o.nC.resolve(K))),[r,i]=(0,s.useState)(!1),[a,l]=(0,s.useState)(!0);return e.length?s.createElement(we,{isVisible:a},s.createElement("div",{style:{marginTop:"20px"}},s.createElement(ue.Z,{onClick:r=>{We(void 0,void 0,void 0,(function*(){var r,s;i(!0),(null===(r=t.currentAttempt)||void 0===r?void 0:r.attemptId)&&e.length&&t.currentQuestion.question&&(yield n.generateSupplementaryQuestion(t.currentAttempt.attemptId,null===(s=t.currentQuestion.question)||void 0===s?void 0:s.questionId,e),n.question||(console.log("no need to generate sup question"),l(!1)))}))},variant:"primary"},"Supplementary question"),s.createElement(be,{type:"DIALOG",size:"xl",show:r,closeButton:!1,handleClose:()=>i(!1)},s.createElement(Je,{store:n,showExtendedFeedback:!1,onChanged:()=>We(void 0,void 0,void 0,(function*(){var e,r,s,o,i;const a=(null===(e=n.feedback)||void 0===e?void 0:e.messages)&&"ERROR"===(null===(r=n.feedback.messages)||void 0===r?void 0:r[0].type)&&(null===(s=n.feedback.messages)||void 0===s?void 0:s[0].violationLaws)||[];if(!a.length)return console.log("empty violation laws"),void l(!1);(null===(o=t.currentAttempt)||void 0===o?void 0:o.attemptId)&&t.currentQuestion.question?(yield n.generateSupplementaryQuestion(t.currentAttempt.attemptId,null===(i=t.currentQuestion.question)||void 0===i?void 0:i.questionId,a),n.question||(console.log("no need to generate sup question"),l(!1))):console.log("problems with attempt")}))})))):null}));const Je=(0,ce.Pi)((({store:e,showExtendedFeedback:t,onChanged:n})=>{const r=e.question;return e.isQuestionLoading?s.createElement(Ee,null):r?s.createElement(s.Fragment,null,s.createElement(Fe,{question:r,answers:e.answersHistory,getAnswers:()=>e.answersHistory,onChanged:t=>{return r=void 0,s=void 0,i=function*(){e.isHistoryChanged(t)&&(yield e.updateAnswersHistory(t),null==n||n(t))},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{l(i.next(e))}catch(e){t(e)}}function a(e){try{l(i.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,a)}l((i=i.apply(r,s||[])).next())}));var r,s,o,i},feedback:e.feedback}),s.createElement(Ke,{store:e,showExtendedFeedback:t})):null})),Ke=(0,ce.Pi)((({store:e,showExtendedFeedback:t})=>{var n;const{feedback:r,isFeedbackLoading:o,isQuestionLoading:i}=e;return o?s.createElement(Ee,null):!r||i?null:s.createElement("div",{className:"comp-ph-feedback-wrapper"},s.createElement("p",null,null===(n=r.messages)||void 0===n?void 0:n.map((e=>s.createElement(Ye,{message:e,showGenerateSupQuestion:t})))),s.createElement(we,{isVisible:t},s.createElement("p",null,s.createElement(we,{isVisible:null!==r.grade},s.createElement(Ve.Z,{variant:"primary"},"Grade: ",r.grade)," "),s.createElement(we,{isVisible:null!==r.correctSteps},s.createElement(Ve.Z,{variant:"success"},"Correct steps: ",r.correctSteps)," "),s.createElement(we,{isVisible:l(r.stepsWithErrors)&&r.stepsWithErrors>0},s.createElement(Ve.Z,{variant:"danger"},"Steps with errors: ",r.stepsWithErrors)," "),s.createElement(we,{isVisible:l(r.stepsLeft)&&r.stepsLeft>0},s.createElement(Ve.Z,{variant:"info"},"Steps left: ",r.stepsLeft)," "))))})),Ye=({message:e,showGenerateSupQuestion:t})=>{const n="SUCCESS"===e.type?"success":"danger";return s.createElement(Xe.Z,{variant:n},e.message,s.createElement(we,{isVisible:t},s.createElement(Ue,{violationLaws:"ERROR"===e.type&&e.violationLaws||[]})))},et=(0,ce.Pi)((()=>{const[e]=(0,s.useState)((()=>o.nC.resolve(oe)));return s.createElement(Je,{store:e.currentQuestion,showExtendedFeedback:!0})}));var tt=function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};const nt=(0,ce.Pi)((()=>{const[e]=(0,s.useState)((()=>o.nC.resolve(oe))),[t,n]=(0,s.useState)("INITIAL");(0,s.useEffect)((()=>{tt(void 0,void 0,void 0,(function*(){e.currentQuestion.question?n("EXERCISE"):(yield e.loadSessionInfo(),(yield e.loadExistingExerciseAttempt())?n("MODAL"):(n("EXERCISE"),yield i()))}))}),[]);const r=()=>tt(void 0,void 0,void 0,(function*(){var t,n,r,s,o;if(null===(t=e.currentAttempt)||void 0===t?void 0:t.questionIds.length){const t=null===(n=e.currentAttempt)||void 0===n?void 0:n.questionIds.length;yield e.currentQuestion.loadQuestion(null===(r=e.currentAttempt)||void 0===r?void 0:r.questionIds[t-1])}else yield e.currentQuestion.generateQuestion(null!==(o=null===(s=e.currentAttempt)||void 0===s?void 0:s.attemptId)&&void 0!==o?o:-1)})),i=()=>tt(void 0,void 0,void 0,(function*(){e.currentQuestion.isQuestionLoading=!0,yield e.createExerciseAttempt(),yield r()}));return s.createElement(ye,{isLoading:"INITIAL"===t},s.createElement(we,{isVisible:"EXERCISE"===t},s.createElement(ge,null),s.createElement(et,null),s.createElement(Ce,null),s.createElement(pe,null)),s.createElement(we,{isVisible:"MODAL"===t},s.createElement(be,{type:"DIALOG",title:"Found existing attempt",primaryBtnTitle:"Continue",handlePrimaryBtnClicked:()=>{n("EXERCISE"),r()},secondaryBtnTitle:"New",handleSecondaryBtnClicked:()=>{n("EXERCISE"),i()}},s.createElement("p",null,"Would you like to continue the existing attempt or start a new one?"))))}));const rt=()=>{const[e,t]=(0,s.useState)([]),[n,r]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{var e,n,s,i;e=void 0,n=void 0,i=function*(){const e=new URLSearchParams(window.location.search).get("exerciseId");if(null===e||Number.isNaN(+e))throw new Error("Invalid exerciseId url param");const n=o.nC.resolve("ExerciseController");r(!0);const s=yield n.getExerciseStatistics(+e);j.isRight(s)&&t(s.right),r(!1)},new((s=void 0)||(s=Promise))((function(t,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof s?n:new s((function(e){e(n)}))).then(o,a)}l((i=i.apply(e,n||[])).next())}))}),[]),s.createElement("div",null,s.createElement("table",{className:"table"},s.createElement("thead",null,s.createElement("tr",null,s.createElement("th",{scope:"col"},"AttemptId"),s.createElement("th",{scope:"col"},"QuestionsCount"),s.createElement("th",{scope:"col"},"TotalInteractionsCount"),s.createElement("th",{scope:"col"},"TotalInteractionsWithErrorsCount"),s.createElement("th",{scope:"col"},"AverageGrade"))),s.createElement("tbody",null,s.createElement(ye,{isLoading:n},e.map((e=>s.createElement("tr",null,s.createElement("th",{scope:"row"},e.attemptId),s.createElement("td",null,e.questionsCount),s.createElement("td",null,e.totalInteractionsCount),s.createElement("td",null,e.totalInteractionsWithErrorsCount),s.createElement("td",null,e.averageGrade))))))))};(0,r.hydrate)(s.createElement((()=>s.createElement("div",{className:"container comp-ph-container"},s.createElement(le.VK,null,s.createElement(de.rs,null,s.createElement(de.AW,{path:"/**/pages/statistics"},s.createElement(rt,null)),s.createElement(de.AW,{path:"/**/pages/exercise"},s.createElement(nt,null)))))),null),document.getElementById("root"))}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var o=n[e]={exports:{}};return t[e].call(o.exports,o,o.exports,r),o.exports}r.m=t,e=[],r.O=(t,n,s,o)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,s,o]=e[d],a=!0,l=0;l<n.length;l++)(!1&o||i>=o)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(a=!1,o<i&&(i=o));a&&(e.splice(d--,1),t=s())}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[n,s,o]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={47:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var s,o,[i,a,l]=n,d=0;for(s in a)r.o(a,s)&&(r.m[s]=a[s]);if(l)var c=l(r);for(t&&t(n);d<i.length;d++)o=i[d],r.o(e,o)&&e[o]&&e[o][0](),e[i[d]]=0;return r.O(c)},n=self.webpackChunkcomp_prehension=self.webpackChunkcomp_prehension||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var s=r.O(void 0,[736],(()=>r(1792)));s=r.O(s)})();