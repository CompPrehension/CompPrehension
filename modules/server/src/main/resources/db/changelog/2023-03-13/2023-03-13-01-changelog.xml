<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.5.xsd">
    <changeSet author="Mikhail Denisov" id="1678657094160-1">
    	<validCheckSum>ANY</validCheckSum>
    	<preConditions onFail="MARK_RAN">
    	    <sqlCheck expectedResult="0">
    	        SELECT EXISTS
    	           (SELECT 1 FROM information_schema.tables
    	            WHERE table_schema = (SELECT DATABASE()) AND table_name = 'question_request_log');
    	    </sqlCheck>
    	</preConditions>
        <createTable tableName="question_request_log">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="exercise_attempt_id" type="BIGINT"/>

            <column name="target_concept_names" type="JSON"/>
            <column name="target_concept_names_in_plan" type="JSON"/>
            <column name="denied_concept_names" type="JSON"/>
            <column name="allowed_concept_names" type="JSON"/>

            <column name="target_law_names" type="JSON"/>
            <column name="target_law_names_in_plan" type="JSON"/>
            <column name="denied_law_names" type="JSON"/>
            <column name="allowed_law_names" type="JSON"/>

            <column name="denied_question_names" type="JSON"/>
            <column name="denied_question_meta_ids" type="JSON"/>
            <column name="denied_question_template_ids" type="JSON"/>

            <column name="solving_duration" type="INT"/>
            <column name="complexity" type="DOUBLE"/>

            <column name="complexity_search_direction" type="INT"/>
            <column name="laws_search_direction" type="INT"/>
            <column name="chance_to_pick_autogenerated_question" type="DOUBLE" defaultValue="1"/>

            <column name="found_count" type="INT" defaultValue="0"/>
            <column name="date" type="datetime"/>
        </createTable>
    </changeSet>
</databaseChangeLog>
